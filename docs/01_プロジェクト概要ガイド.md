# FlightAcademyTsx プロジェクト概要ガイド

## 📖 このドキュメントを読むべき人

- ✅ **AIアシスタント**: プロジェクトの機能と技術スタックを理解したい場合
- ✅ **新規開発者**: プロジェクトの主要機能を把握したい場合
- ✅ **ステークホルダー**: プロジェクトの機能一覧を確認したい場合

**推奨読み順**: [docs/README.md](README.md) → [00_WhiskyPapa_Transformation_Guide.md](00_WhiskyPapa_Transformation_Guide.md) → このドキュメント

---

## 📋 プロジェクト概要

FlightAcademyTsxは、航空機パイロット向けの包括的な学習・計画プラットフォームです。React+TypeScript+Supabaseを基盤とし、学習コンテンツ管理、進捗・テスト連携、ソーシャル機能、認証、SPAルーティング、パフォーマンス最適化などを実現しています。記事はログインユーザーのみがアクセス可能で、セクションベースの進捗管理システムを採用しています。

**最終更新**: 2026年2月1日
**バージョン**: Project Overview Guide v2.3

---

## 🎯 主な機能

### **学習コンテンツ管理**
- **MDXベースの記事システム**: Markdown + JSX形式で学習記事を管理
- **カテゴリー管理**: 基礎知識、メンタリティー、技術、実践の4カテゴリ
- **進捗管理**: ユーザー別の詳細な学習進捗トラッキング
- **タグ管理**: 記事の分類・検索機能

### **進捗・テスト連携**
- **CPL試験システム統合**: 学習記事とテスト問題の連携
- **学習-テストマッピング**: 記事内容と試験問題の関連付け
- **進捗ダッシュボード**: 学習状況の可視化

### **ソーシャル機能**
- **いいね・コメント機能**: 学習記事にTwitterライクなソーシャル機能
- **ユーザープロフィール**: アバター設定、プロフィール管理
- **ロール管理**: Student/Teacher/Admin の権限管理

### **フリーミアム公開**
- **一部記事無料公開**: 1.4, 1.5, 1.6記事等を無料で提供
- **アクセス制御**: 未ログインユーザー向けの適切な制限
- **ログイン促進**: 制限コンテンツへのアクセス時のログイン誘導

### **シリーズ順次アンロック機能（2025年11月2日実装）**
- **順次解放システム**: シリーズ記事を1話から順に読了で解放
- **未ログインユーザー**: 各シリーズの1話のみ閲覧可能
- **ログインユーザー**: 直前話の読了で次話が自動解放

### **認証**
- **メール/パスワード認証**: 基本的な認証機能
- **セッション管理**: 自動セッション更新、永続化
- **OAuth拡張予定**: Google、GitHub等の外部認証対応予定

### **SPAルーティング**
- **Marketing Routes**: `/`, `/about`, `/mission`, `/shop`, `/gallery`, `/blog`, `/blog/:slug`, `/experience`
- **App Routes**: `/dashboard`, `/planning`, `/learning`, `/articles`, `/account`, `/auth`, `/test`
- **コード分割**: React.lazyによる動的インポート
- **404ハンドリング**: 未定義パスの適切な処理

### **パフォーマンス最適化**
- **仮想化システム**: react-windowによる大量データの効率的表示
- **バンドル最適化**: 77.5%のバンドルサイズ削減を達成
- **Core Web Vitals対応**: LCP < 2.5秒、FID < 100ms、CLS < 0.1

### **フライトプランニング**
- **インタラクティブ地図**: Leaflet.jsベースの航空地図表示
- **空港・NAVAID情報**: GeoJSON形式の地理データ管理
- **一般気象情報**: WeatherAPI.comによるリアルタイム気象データ取得
- **METAR/TAF統合**: NOAA Aviation Weather Center APIによる航空気象情報
- **サーバーサイドプロキシ**: CORS問題の解決とAPI呼び出しの最適化

### **お知らせ機能（2025年11月2日実装）**
- **Supabase統合**: `announcements`テーブルから最新情報を取得
- **HomePage統合**: Heroセクション直後に最新5件をカード形式で表示
- **レスポンシブデザイン**: モバイル1列、タブレット2列、デスクトップ3-5列のグリッドレイアウト

### **Whisky Papa ブランド機能（2025年1月実装）**

#### **Phase 1: Brand Foundation**
- **MarketingLayout**: 黒×黄色基調の広報レイアウト（Framer Motionアニメーション）
- **AppLayout**: HUD固定スタイル（Dayモード、HUDグリーン `#39FF14`）
- **Home Page**: ランディングページ（Heroセクション、Wingman Program紹介）
- **About Page**: チームメンバー紹介とExtra 300L機体スペック

#### **Phase 2: Gamification (Wingman Program)**
- **ランクシステム**: 統合ランクシステム（PPL中間ランク + XPベースランク）
  - PPL中間ランク: Phase、Section、Category、Subjectレベル（記事完了ベース）
  - XPベースランク: Fan → PPL → Wingman → CPL → Ace → Master → Legend
- **XPシステム**: ミッション達成でXP獲得、ランクアップ判定
- **ミッションシステム**: クイズ完了、記事読了、プラン作成などのアクションで自動達成
- **Mission Dashboard**: ランク・XP・ミッション進捗の可視化

#### **Phase 3: Engagement (Shop & Gallery)**
- **Hangar Store**: ランク連動型ショップ
- **Interactive Gallery**: ファン投稿写真ギャラリー
  - イベント管理機能（アクティブイベントとアーカイブイベント）
  - いいね機能（承認済み写真のみ、アクティブイベントのみ）
  - Top3表示、ソート機能、タブ機能（公開/自分の投稿/管理）

---

## 🛠️ 技術スタック

### **フロントエンド**
- **React 18**: Concurrent Mode、Suspense、useTransition
- **TypeScript**: 型安全性、開発効率向上
- **Vite**: 高速ビルドツール、動的チャンク分割
- **Tailwind CSS**: ユーティリティファーストのCSSフレームワーク

### **バックエンド**
- **Supabase**: データベース、認証、リアルタイム機能
- **PostgreSQL**: リレーショナルデータベース

### **地図・ナビゲーション**
- **Leaflet**: インタラクティブ地図ライブラリ
- **React-Leaflet**: React用Leafletラッパー
- **GeoJSON**: 地理データ形式

### **外部API**
- **WeatherAPI.com**: 一般気象情報API（要APIキー）
- **NOAA Aviation Weather Center API**: 航空気象データAPI（認証不要・無料）

---

## 📊 データベース拡張

### **主要テーブル**
- **profiles**: ユーザープロファイル
- **questions**: 問題データ
- **learning_records**: 学習記録
- **user_question_srs_status**: SRS（間隔反復学習）ステータス
- **gallery_events**: Galleryイベント管理
- **fan_photos**: ユーザー投稿写真
- **fan_photo_likes**: いいねデータ
- **learning_progress**: 記事学習進捗
- **learning_content_comments**: 記事コメント

---

## 🎨 新規コンポーネント

### **Gallery機能（2025年12月実装）**
- **PhotoGrid**: 写真グリッド表示（Masonryレイアウト、Lightbox機能）
- **UploadModal**: 写真アップロードモーダル（ドラッグ&ドロップ対応）
- **AdminEventPanel**: イベント管理パネル（管理者専用）
- **AdminReviewPanel**: 承認管理パネル（管理者専用）

### **記事システム**
- **ArticleDetailPage**: 記事詳細ページ
- **ReadingProgressBar**: 残り時間表示・進捗管理
- **MDXLoader**: 動的記事読み込み
- **CommentSection**: コメント機能
- **TableOfContents**: 目次・ナビゲーション

---

## 📝 最近の変更

### **2025年12月26日**
- `docs/db`ディレクトリを削除（記事作成作業管理用ファイル）
- ドキュメント軽量化作業完了

### **2025年12月24日**
- 飛行計画エクスポート/インポート・燃料計算・印刷機能実装
- リポジトリ整理作業完了

### **2025年12月21日**
- HUDテーマ削除、Whisky Papaテーマ統一
- プロフィールページUI改善

### **2025年12月14日**
- MarketingLayout統合とコンテンツ改善
- ナビゲーション機能の拡張、認証ページのリブランディング

### **2025年11月2日**
- シリーズ順次アンロック機能実装
- お知らせ機能追加

**詳細な変更履歴はGitのコミット履歴を参照してください。**

---

## 🧪 テスト・CI/CD（2025年1月追加）

### **テストフレームワーク**
- **Vitest**: テストフレームワーク（39テスト、6ファイル）
- **Testing Library**: Reactコンポーネントテスト
- **カバレッジ**: v8プロバイダー、閾値設定済み

### **CI/CDパイプライン**
- **GitHub Actions**: プルリクエスト・プッシュ時に自動実行
- **自動検証**: Lint、テスト、ビルド、カバレッジレポート
- **カバレッジコメント**: プルリクエストに自動追加

詳細は [プロジェクトルートのREADME.md](../README.md#テスト) を参照してください。

---

**最終更新**: 2025年1月（CI/CD統合・テスト設定追加）
**バージョン**: Project Overview Guide v2.3
**管理者**: FlightAcademy開発チーム
