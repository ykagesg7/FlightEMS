# FlightAcademyTsx - 開発参加ガイド

このドキュメントでは、FlightAcademyTsxプロジェクトへの貢献方法について説明します。バグ報告、機能リクエスト、コード貢献など、プロジェクトに参加するためのガイドラインを提供します。

## 関連ドキュメント
- [プロジェクト概要](./README.md)
- [開発ガイド](./DEVELOPMENT.md)
- [高度な機能とトラブルシューティング](./ADVANCED.md)
- [開発ロードマップ](./ROADMAP.md)

## クイックスタート

1. リポジトリをフォークする
2. フォークしたリポジトリをクローンする：`git clone https://github.com/あなたのユーザー名/FlightAcademyTsx.git`
3. 依存関係をインストールする：`npm install`
4. 環境変数を設定する：`.env.local`ファイルを作成
5. 開発サーバーを起動する：`npm run dev`

## 環境変数の設定

`.env.example`ファイルを参照し、必要な環境変数を`.env.local`に設定してください。少なくとも以下の変数が必要です：

```
VITE_WEATHER_API_KEY=your_weather_api_key
```

**重要**: APIキーなどの機密情報をコードに直接ハードコードしないでください。常に環境変数を使用してください。

## 開発フロー

1. 新しいブランチを作成する：`git checkout -b feature/あなたの機能名`
2. 変更を加える
3. コードの品質を確認する：`npm run lint`
4. テストを実行する：`npm run test`（※現在テストは実装段階です）
5. 変更をコミットする：`git commit -m "機能の説明"`
6. フォークしたリポジトリにプッシュする：`git push origin feature/あなたの機能名`
7. プルリクエストを作成する

## コーディング規約

### 命名規則

- **コンポーネント**: PascalCase（例: `FlightParameters.tsx`）
- **関数**: camelCase（例: `calculateDistance`）
- **変数**: camelCase（例: `totalDistance`）
- **定数**: UPPER_SNAKE_CASE（例: `MAX_ALTITUDE`）
- **ファイル名**: コンポーネントはPascalCase、その他はcamelCase

### TypeScript

- 可能な限り`any`型を避け、具体的な型または型定義を使用する
- 複雑なデータ構造には適切なインターフェイスを定義する
- optional chainingを活用して型安全性を確保する
- 非同期操作には適切なエラーハンドリングを実装する

### ファイル構成

- 関連するロジックは適切なディレクトリに配置する
- コンポーネントはできるだけ小さく、再利用可能にする
- ビジネスロジックとUI表示を分離する
- ユーティリティ関数は`utils`ディレクトリに配置する

### スタイリング

- Tailwind CSSのユーティリティクラスを活用する
- コンポーネント特有のスタイルは適切に名前空間を分ける
- レスポンシブデザインを考慮する
- アクセシビリティガイドラインに従う

## マニューバービューア機能の開発参加ガイド

マニューバービューアは、編隊飛行などの複雑な機動を視覚的に理解するための重要な教育ツールです。この機能の開発に参加する場合は、以下のガイドラインに従ってください。

### ディレクトリ構造

```
public/
└── maneuver/
    ├── straight_join.html
    ├── turning_join.html
    └── [新しいマニューバーファイル].html
```

### 新しいマニューバーアニメーションの追加

1. `public/maneuver/` ディレクトリに新しいHTMLファイルを作成します。
2. 既存のマニューバーファイルをテンプレートとして使用できます。
3. 新しいファイル名は機動の種類を明確に示すものにしてください（例: `formation_change.html`）。
4. 次の構造に従います：
   - HTML5 Canvasを使用した描画領域
   - 制御用UIコンポーネント（再生、一時停止、リセットなど）
   - JavaScript関数によるアニメーション処理

### マニューバーアニメーションのコーディングガイドライン

1. **モジュール化：**
   - 描画関数、更新関数、初期化関数など、機能ごとに関数を分離する
   - グローバル変数の使用を最小限に抑える

2. **物理モデルの正確性：**
   - 航空機の動きは実際の物理法則に基づいて計算する
   - 速度、加速度、旋回半径などのパラメータを現実的な値に設定する

3. **パフォーマンス最適化：**
   - 重い計算は必要な時だけ実行する
   - `requestAnimationFrame`を使用したアニメーションフレーム管理
   - 不要な再描画を避ける

4. **アクセシビリティ：**
   - コントロールは適切なラベルを付ける
   - キーボード操作もサポートする

5. **レスポンシブデザイン：**
   - Canvasのサイズを親コンテナに合わせて調整する
   - 異なる画面サイズでも正しく表示されるようにする

## データ管理に関する注意事項

### ウェイポイントデータの更新

1. ウェイポイントを編集する場合は、アルファベット別のファイル（例: `waypoints_A.json`）を直接編集してください
2. ファイルを編集した後は、必ずマージスクリプトを実行してください：
   ```
   node scripts/mergeWaypoints.cjs
   ```
3. 地域別ファイルを更新するには、分割スクリプトを実行してください：
   ```
   node public/geojson/split-waypoints-regions.mjs
   ```

### 気象データの扱い

- Weather APIへのリクエストを最小限に抑えるため、キャッシュを利用してください
- WeatherCacheContextを活用して、コンポーネント間でデータを共有してください
- 気象データの取得時には適切なローディング状態を表示してください

### マニューバーアニメーションデータの管理

1. マニューバーアニメーションのパラメータは、必要に応じて外部JSONファイルに分離することを検討してください。
2. 複雑なアニメーションシーケンスは、JSONファイルでシーケンスを定義し、それを読み込む方式にすると保守性が向上します。
3. 新しいマニューバーファイルを追加した場合は、適切に`git add`コマンドでステージングしてください。
   ```
   git add public/maneuver/your_new_maneuver.html
   ```

## Cursor.AIを使ったコード品質向上

1. **コードレビュー**
   - コミット前にAIアシスタントにコードレビューを依頼
   - 「このコードをレビューして最適化してください」と質問

2. **バグの特定と修正**
   - エラーメッセージをAIアシスタントに共有して解決策を得る
   - 「このエラーの原因と修正方法を教えてください」と質問

3. **ドキュメント生成**
   - コードからドキュメントを自動生成
   - 「このクラス/関数のドキュメントを生成してください」と依頼

## プルリクエスト

プルリクエストを提出する前に、以下のチェックリストを確認してください：

- [ ] コードはTypeScriptの型安全性に準拠している
- [ ] 新しいコンポーネントはコンポーネント命名規則に従っている
- [ ] コードは既存のスタイルガイドに従っている
- [ ] すべての不要なコンソールログとデバッグコードが削除されている
- [ ] 既存の機能が損なわれていないことを確認した
- [ ] ドキュメントが更新されている（必要な場合）
- [ ] 環境変数の変更がある場合は`.env.example`が更新されている

## セキュリティガイドライン

- APIキーなどの機密情報をコードに直接含めないでください
- ユーザー入力は適切にバリデーションしてください
- フォーク時にはAPIキーを含む環境変数をリセットしてください
- プルリクエスト内で機密情報が公開されていないことを確認してください

## サポート

質問や支援が必要な場合は、Issueを作成するか、プロジェクト管理者に連絡してください。技術的な議論はIssue内で行うことを推奨します。

---

最終更新日: 2024年7月10日 