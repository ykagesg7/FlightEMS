# FlightAcademyTsx è¨­è¨ˆä»•æ§˜æ›¸

## ğŸ“‹ æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€FlightAcademyTsxãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è©³ç´°ãªè¨­è¨ˆä»•æ§˜ã€APIä»•æ§˜ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã€UI/UXä»•æ§˜ã«ã¤ã„ã¦åŒ…æ‹¬çš„ã«èª¬æ˜ã—ã¾ã™ã€‚

**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ13æ—¥
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: Design Specification v1.5

---

## ğŸ“š è¨˜äº‹ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆï¼ˆPhase 5å®Ÿè£…æ¸ˆã¿ï¼‰

### **è¨˜äº‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†**

#### **ArticleMetaå‹å®šç¾©**
```typescript
export type ArticleMeta = {
  type: 'article';
  title: string;
  slug: string;
  tags: string[];
  series?: string;
  order?: number;
  readingTime?: number;
  excerpt?: string;
  publishedAt?: string;
  author?: string;
  heroImage?: string;
};
```

#### **è¨˜äº‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚·ã‚¹ãƒ†ãƒ **
- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ç®¡ç†**: `import.meta.glob`ã«ã‚ˆã‚‹å‹•çš„è¨˜äº‹åé›†
- **å‹å®‰å…¨ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**: `ArticleIndexEntry`ã«ã‚ˆã‚‹æ§‹é€ åŒ–ç®¡ç†
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ãŸã‚ã®è¨˜äº‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: ã‚¿ã‚°ã€ã‚·ãƒªãƒ¼ã‚ºã€è‘—è€…ã«ã‚ˆã‚‹é«˜åº¦ãªæ¤œç´¢æ©Ÿèƒ½

### **è¨˜äº‹è¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ **

#### **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ**
```
ArticleDetailPage
â”œâ”€â”€ ReadingProgressBar (é€²æ—è¡¨ç¤ºãƒ»ãƒ—ãƒªãƒ•ã‚§ãƒƒãƒ)
â”œâ”€â”€ MDXLoader (å‹•çš„è¨˜äº‹èª­ã¿è¾¼ã¿)
â”‚   â””â”€â”€ MDXContent
â”‚       â”œâ”€â”€ ArticleHeader (ãƒ¡ã‚¿æƒ…å ±è¡¨ç¤º)
â”‚       â”œâ”€â”€ TableOfContents (ç›®æ¬¡ãƒ»ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³)
â”‚       â”œâ”€â”€ MDXContentWithTheme (è¨˜äº‹æœ¬æ–‡)
â”‚       â””â”€â”€ RelatedArticles (é–¢é€£è¨˜äº‹æ¨è–¦)
â””â”€â”€ ScrollToButtons (ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ”¯æ´)
```

#### **ä¸»è¦æ©Ÿèƒ½**
- **èª­æ›¸é€²æ—è¿½è·¡**: ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã«ã‚ˆã‚‹é€²æ—è¨ˆç®—
- **æ®‹ã‚Šæ™‚é–“è¡¨ç¤º**: å‹•çš„ãªèª­äº†æ™‚é–“äºˆæ¸¬
- **ç›®æ¬¡ç”Ÿæˆ**: è¦‹å‡ºã—ã®è‡ªå‹•æŠ½å‡ºãƒ»ã‚¢ãƒ³ã‚«ãƒ¼ãƒªãƒ³ã‚¯ç”Ÿæˆ
- **é–¢é€£è¨˜äº‹æ¨è–¦**: ã‚¿ã‚°ãƒ»ã‚·ãƒªãƒ¼ã‚ºãƒ™ãƒ¼ã‚¹ã®è‡ªå‹•æ¨è–¦
- **SEOæœ€é©åŒ–**: JSON-LDã€OGã‚¿ã‚°ã®è‡ªå‹•ç”Ÿæˆ

### **å­¦ç¿’é€²æ—ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ2025å¹´10æœˆ13æ—¥å®Ÿè£…ï¼‰**

#### **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ**
```sql
-- learning_progressãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE learning_progress (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  content_id TEXT NOT NULL,
  completed BOOLEAN DEFAULT false,
  progress_percentage INTEGER DEFAULT 0 CHECK (progress_percentage >= 0 AND progress_percentage <= 100),
  last_position INTEGER DEFAULT 0,
  last_read_at TIMESTAMPTZ,
  read_count INTEGER DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now(),
  CONSTRAINT learning_progress_user_id_content_id_key UNIQUE (user_id, content_id)
);
```

#### **é€²æ—è¿½è·¡æ©Ÿèƒ½**

**useArticleProgress Hook**
```typescript
// Supabaseã¨ã®é€£æº
- ãƒšãƒ¼ã‚¸é›¢è„±æ™‚ã«é€²æ—ã‚’è‡ªå‹•ä¿å­˜ï¼ˆ95%ä»¥ä¸Šã§å®Œäº†åˆ¤å®šï¼‰
- æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ›´æ–°ã€æ–°è¦ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æŒ¿å…¥ï¼ˆUPSERTï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«å…¨é€²æ—ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•èª­ã¿è¾¼ã¿
- ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ã¨SupabaseçŠ¶æ…‹ã®åŒæœŸç®¡ç†
```

**ReadingProgressBar Component**
```typescript
// é€²æ—ä¿å­˜ã‚¿ã‚¤ãƒŸãƒ³ã‚°
- ãƒšãƒ¼ã‚¸é›¢è„±æ™‚ï¼ˆunmountæ™‚ï¼‰ã®ã¿ä¿å­˜
- 5%æœªæº€ã®èª¤ã‚¯ãƒªãƒƒã‚¯ã¯ä¿å­˜ã—ãªã„
- 95%ä»¥ä¸Šã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§è‡ªå‹•çš„ã«å®Œäº†ãƒãƒ¼ã‚¯
- ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ä¿å­˜å¯¾è±¡
```

**ProgressSidebar Component**
```typescript
// ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤º
- ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥é€²æ—ã®é›†è¨ˆï¼ˆè¨˜äº‹ã®tags[0]ã‹ã‚‰åˆ¤å®šï¼‰
- å®Ÿéš›ã®é€²æ—ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãçµ±è¨ˆè¡¨ç¤º
- å®Œäº†è¨˜äº‹æ•°ã€ç·è¨˜äº‹æ•°ã€é”æˆç‡ã®å¯è¦–åŒ–
```

#### **é€²æ—ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼**
```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¨˜äº‹ã‚’èª­ã‚€
   â†“
2. ReadingProgressBarãŒã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é€²æ—ã‚’è¿½è·¡
   â†“
3. ãƒšãƒ¼ã‚¸é›¢è„±æ™‚ï¼ˆåˆ¥ãƒšãƒ¼ã‚¸ã¸é·ç§»ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹ï¼‰
   â†“
4. useArticleProgress.updateArticleProgress()ãŒå‘¼ã°ã‚Œã‚‹
   â†“
5. Supabase learning_progressãƒ†ãƒ¼ãƒ–ãƒ«ã«UPSERT
   - æ—¢å­˜: progress_percentage, completedç­‰ã‚’æ›´æ–°
   - æ–°è¦: æ–°ã—ã„ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æŒ¿å…¥
   â†“
6. ArticlesDashboardã§é€²æ—ã‚’è¡¨ç¤º
   - useArticleProgress.loadInitialData()ã§å…¨é€²æ—å–å¾—
   - ProgressSidebarã§ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥é€²æ—ã‚’é›†è¨ˆ
```

#### **å®Œäº†åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯**
- **95%ä»¥ä¸Šã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«**: è‡ªå‹•çš„ã«`completed = true`
- **5%æœªæº€ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«**: ä¿å­˜ã—ãªã„ï¼ˆèª¤ã‚¯ãƒªãƒƒã‚¯é˜²æ­¢ï¼‰
- **5%ã€œ95%**: é€²æ—ã®ã¿ä¿å­˜ã€æœªå®Œäº†ã¨ã—ã¦è¨˜éŒ²

### **ãƒ†ãƒ¼ãƒçµ±åˆ**
- **CSSå¤‰æ•°æ´»ç”¨**: `--hud-primary`, `--text-primary`, `--panel`
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ**: ãƒ¢ãƒã‚¤ãƒ«ãƒ»ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—æœ€é©åŒ–
- **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£**: ARIAå¯¾å¿œã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³

### **è¨˜äº‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä¸€è¦§ï¼ˆ2025å¹´10æœˆ12æ—¥æ™‚ç‚¹ï¼‰**

#### **ãƒ¡ãƒ³ã‚¿ãƒªãƒ†ã‚£ãƒ¼ã‚«ãƒ†ã‚´ãƒªãƒ¼**

**æˆ¦é—˜æ©Ÿä¹—ã‚Šã®å¿ƒæ§‹ãˆã‚·ãƒªãƒ¼ã‚ºï¼ˆå®Œçµï¼‰**:
1. `1.3.1_SingleSeatMentality.mdx` - Single Seat Mentality
2. `1.3.2_WingmanMentality.mdx` - Wingman Mentality
3. `1.3.3_DebriefingMentality.mdx` - Debriefing Mentality
4. `1.3.4_ShurabaMentality.mdx` - ä¿®ç¾…å ´Mentality
5. `1.3.5_ResultsAreEverything.mdx` - **çµæœãŒã™ã¹ã¦ï¼ˆNEWï¼‰**
   - å®®æœ¬æ­¦è”µã®ã€Œåƒæ—¥ã®ç¨½å¤ã‚’é›ã¨ã—ã€ä¸‡æ—¥ã®ç¨½å¤ã‚’ç·´ã¨ã™ã€
   - æœ€çµ‚æ¤œå®šå‰å¤œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
   - åœ§å€’çš„ãªæº–å‚™ã¨ã„ã†ç¢ºå›ºãŸã‚‹è‡ªä¿¡

**ï¼—ã¤ã®ç¿’æ…£ã‚·ãƒªãƒ¼ã‚º**:
- `1.1.1_UnconsciousSuccess.mdx` - ä¸»ä½“æ€§
- `1.1.2_EndWithFuture.mdx` - çµ‚ã‚ã‚Šã‚’æ€ã„æãã“ã¨ã‹ã‚‰å§‹ã‚ã‚‹
- `1.1.3_PrioritizingMostImportant.mdx` - æœ€å„ªå…ˆäº‹é …ã‚’å„ªå…ˆã™ã‚‹
- `1.1.4_WinWinThinking.mdx` - Win-Winã‚’è€ƒãˆã‚‹
- `1.1.5_SeekFirstToUnderstand.mdx` - ã¾ãšç†è§£ã«å¾¹ã—ã€ãã—ã¦ç†è§£ã•ã‚Œã‚‹
- `1.1.6_Synergize.mdx` - ã‚·ãƒŠã‚¸ãƒ¼ã‚’å‰µã‚Šå‡ºã™

**ãã®ä»–ãƒ¡ãƒ³ã‚¿ãƒªãƒ†ã‚£ãƒ¼è¨˜äº‹**:
- `1.2.5_RightPeopleOnBoard.mdx` - ãƒ“ã‚¸ãƒ§ãƒŠãƒªãƒ¼ãƒ»ã‚«ãƒ³ãƒ‘ãƒ‹ãƒ¼
- `1.2.6_GiveAndTake.mdx` - GIVE&TAKE ãã®ï¼‘
- `1.2.7_GiveAndTake2.mdx` - GIVE&TAKE ãã®ï¼’

#### **æ€è€ƒæ³•ã‚«ãƒ†ã‚´ãƒªãƒ¼**
- `2.1.1_Thinking.mdx` - æ€è€ƒæ³•å…¥é–€
- `2.1.2_ConcreteAbstract.mdx` - å…·ä½“ã¨æŠ½è±¡
- `2.2.1-2.2.4_LogicalPresentation.mdx` - è«–ç†çš„ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ4éƒ¨ä½œï¼‰
- `2.3.1-2.3.3_AnalogyThinking.mdx` - ã‚¢ãƒŠãƒ­ã‚¸ãƒ¼æ€è€ƒï¼ˆ3éƒ¨ä½œï¼‰
- `2.4.1-2.4.4_MillionaireTeaching.mdx` - Millionaire Teachingï¼ˆ4éƒ¨ä½œï¼‰

---

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### **ç›®çš„**
æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€Webãƒ™ãƒ¼ã‚¹ã®4æŠå•é¡Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¾ã™ã€‚ç‰¹ã«ã€æœ€æ–°ã®è„³ç§‘å­¦ã‚„å­¦ç¿’ç†è«–ã‚’å–ã‚Šå…¥ã‚Œã€åŠ¹ç‡çš„ãªæš—è¨˜ã¨é•·æœŸè¨˜æ†¶ã¸ã®å®šç€ã‚’æ”¯æ´ã™ã‚‹æ©Ÿèƒ½ã‚’ç››ã‚Šè¾¼ã‚€ã“ã¨ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚

### **æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯**
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: React, TypeScript, Vite, Tailwind CSS
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Supabase (PostgreSQL, Auth, Edge Functions)
- **é–‹ç™ºç’°å¢ƒ**: Cursor IDE, GitHub Actions, Vercel

### **é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹**
- é–‹ç™ºãƒãƒ¼ãƒ ãŒåŠ¹ç‡çš„ã«æ©Ÿèƒ½é–‹ç™ºã‚’é€²ã‚ã‚‰ã‚Œã‚‹ã‚ˆã†ã€è©³ç´°ãªä»•æ§˜ã¨è¨­è¨ˆã‚’æä¾›
- AIé–‹ç™ºæ”¯æ´ãƒ„ãƒ¼ãƒ«ï¼ˆGitHub Copilot Workspaceã€LLMç­‰ï¼‰ãŒMVPé–‹ç™ºã‚’åŠ¹ç‡çš„ã«é€²ã‚ã‚‰ã‚Œã‚‹ã‚ˆã†æ§‹é€ åŒ–
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æŠ€è¡“çš„ãªæ„æ€æ±ºå®šã¨è¨­è¨ˆæ ¹æ‹ ã‚’æ–‡æ›¸åŒ–

---

## ğŸ‘¥ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼

### **ä¸»è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼**
- FlightAcademyã®æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼
- äº‹æ¥­ç”¨æ“ç¸¦å£«ï¼ˆé£›è¡Œæ©Ÿï¼‰å›½å®¶è©¦é¨“ã®å­¦ç¿’è€…
- ãã®ä»–ã€è³‡æ ¼è©¦é¨“ã‚„å°‚é–€çŸ¥è­˜ã®ç¿’å¾—ã‚’ç›®æŒ‡ã™å­¦ç¿’è€…å…¨èˆ¬

### **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«**
1. **Student (ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼)**
   - è‡ªèº«ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†ï¼ˆä¸€éƒ¨ï¼‰
   - å•é¡Œã®è§£ç­”
   - è‡ªèº«ã®å­¦ç¿’å±¥æ­´ãƒ»é€²æ—ã®é–²è¦§
   - å•é¡Œã¸ã®ãƒãƒ¼ã‚¯ä»˜ä¸

2. **Teacher**
   - Studentã®å…¨æ¨©é™
   - ï¼ˆæ‹…å½“ã™ã‚‹ï¼‰Studentã®å­¦ç¿’æƒ…å ±ãƒ»é€²æ—ã®é–²è¦§
   - Studentã¸ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ©Ÿèƒ½ï¼ˆå°†æ¥æ¤œè¨ï¼‰
   - ç‰¹å®šã®Studentã‚°ãƒ«ãƒ¼ãƒ—ã¸ã®èª²é¡Œå‰²ã‚Šå½“ã¦ï¼ˆå°†æ¥æ¤œè¨ï¼‰

3. **Admin**
   - Teacherã®å…¨æ¨©é™ï¼ˆå®Ÿè³ªçš„ã«å…¨Studentã®æƒ…å ±ã‚’é–²è¦§å¯èƒ½ï¼‰
   - ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ï¼ˆãƒ­ãƒ¼ãƒ«å¤‰æ›´ãªã©ï¼‰
   - å•é¡Œã‚«ãƒ†ã‚´ãƒªã®ä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤
   - ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒƒã‚­ã®ä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤
   - å•é¡Œã®ä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤ï¼ˆCSVã‚¤ãƒ³ãƒãƒ¼ãƒˆå«ã‚€ï¼‰
   - ã‚·ã‚¹ãƒ†ãƒ è¨­å®šå¤‰æ›´ï¼ˆå°†æ¥æ¤œè¨ï¼‰

---

## ğŸ”§ æ©Ÿèƒ½è¦ä»¶

### **å¿…é ˆæ©Ÿèƒ½ï¼ˆMVPã®ã‚³ã‚¢ï¼‰**

#### **ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½**
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼‰
- âœ… ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
- âœ… ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆï¼ˆSupabase Authæ¨™æº–æ©Ÿèƒ½åˆ©ç”¨ï¼‰

#### **å•é¡Œã‚«ãƒ†ã‚´ãƒªæ©Ÿèƒ½**
- âœ… äº‹å‰å®šç¾©ã•ã‚ŒãŸã‚«ãƒ†ã‚´ãƒªè¡¨ç¤ºï¼ˆä¾‹: èˆªæ³•, èˆªç©ºæ³•è¦, æ°—è±¡, æ©Ÿä½“, é€šä¿¡ï¼‰
- ğŸ”„ ï¼ˆAdminå‘ã‘ï¼‰ã‚«ãƒ†ã‚´ãƒªä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤æ©Ÿèƒ½

#### **ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒƒã‚­æ©Ÿèƒ½**
- âœ… ã‚«ãƒ†ã‚´ãƒªã«ç´ã¥ããƒ‡ãƒƒã‚­ã®ä¸€è¦§è¡¨ç¤º
- âœ… ãƒ‡ãƒƒã‚­é¸æŠæ©Ÿèƒ½
- ğŸ”„ ï¼ˆAdminå‘ã‘ï¼‰ãƒ‡ãƒƒã‚­ä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤æ©Ÿèƒ½

#### **4æŠå•é¡Œè§£ç­”æ©Ÿèƒ½**
- âœ… å•é¡Œæ–‡ã¨4ã¤ã®é¸æŠè‚¢ã®è¡¨ç¤º
- âœ… è§£ç­”é¸æŠæ©Ÿèƒ½ï¼ˆãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³å½¢å¼ãªã©ï¼‰
- âœ… è§£ç­”é€ä¿¡æ©Ÿèƒ½
- âœ… æ­£èª¤åˆ¤å®šã¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¡¨ç¤ºï¼ˆæ­£è§£ã®é¸æŠè‚¢ã€è§£èª¬æ–‡ã€è§£èª¬ç”»åƒï¼‰
- âœ… æ¬¡ã®å•é¡Œã¸é€²ã‚€æ©Ÿèƒ½

#### **ã‚¹ã‚³ã‚¢ãƒ»é€²æ—ç®¡ç†æ©Ÿèƒ½**
- âœ… å­¦ç¿’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã”ã¨ã®ã‚¹ã‚³ã‚¢è¡¨ç¤ºï¼ˆæ­£è§£æ•°/å•é¡Œæ•°, æ­£è§£ç‡ï¼‰
- âœ… ï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼‰ç·å­¦ç¿’å•é¡Œæ•°ã€å¹³å‡æ­£è§£ç‡ã€å­¦ç¿’æ—¥æ•°ã®è¡¨ç¤º
- ğŸ”„ ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰æ©Ÿèƒ½ï¼ˆMVPç¯„å›²å¤–ã€å°†æ¥æ¤œè¨ï¼‰

### **ä¾¿åˆ©æ©Ÿèƒ½ï¼ˆMVPã«å«ã‚ã‚‹å­¦ç¿’æ”¯æ´æ©Ÿèƒ½ï¼‰**

#### **å­¦ç¿’æ”¯æ´æ©Ÿèƒ½**
- âœ… é›£æ˜“åº¦ãƒ¬ãƒ™ãƒ«è¨­å®šï¼ˆå•é¡Œã”ã¨ã« 'easy', 'medium', 'hard' ã‚’è¨­å®šï¼‰
- âœ… ã‚¿ã‚¤ãƒãƒ¼æ©Ÿèƒ½
  - ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã§ä¸€å¾‹ã®è¦å®šæ™‚é–“ï¼ˆä¾‹: 60ç§’/å•ï¼‰ã‹ã‚‰ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³è¡¨ç¤º
  - æ®‹ã‚Šæ™‚é–“0ç§’ã«ãªã£ã¦ã‚‚è§£ç­”ã¯ç¶šè¡Œå¯èƒ½
  - è§£ç­”ã«ã‹ã‹ã£ãŸæ™‚é–“ã‚’è¨˜éŒ²ï¼ˆ`learning_records.response_time_ms`ï¼‰
- âœ… å¾©ç¿’æ©Ÿèƒ½
  - é–“é•ãˆãŸå•é¡Œã®å†å‡ºé¡Œ
  - SRSï¼ˆé–“éš”åå¾©å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã«ã‚ˆã‚‹å¾©ç¿’å•é¡Œã®æç¤º
- âœ… è§£èª¬æ–‡ã¸ã®ç”»åƒæ·»ä»˜æ©Ÿèƒ½ï¼ˆå•é¡Œä½œæˆæ™‚ï¼‰

#### **ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆå‘ä¸Šæ©Ÿèƒ½**
- âœ… ï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼‰ã‚«ãƒ†ã‚´ãƒªåˆ¥æ­£ç­”ç‡ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆï¼ˆè‹¦æ‰‹åˆ†é‡ã®å¯è¦–åŒ–ï¼‰
- ğŸ”„ ãƒ‡ã‚¤ãƒªãƒ¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼ˆMVPç¯„å›²å¤–ã€å°†æ¥æ¤œè¨ï¼‰
- ğŸ”„ å ±é…¬ãƒ»ãƒãƒƒã‚¸ã‚·ã‚¹ãƒ†ãƒ ï¼ˆMVPç¯„å›²å¤–ã€å°†æ¥æ¤œè¨ï¼‰
 - âœ… Lessons æ¤œç´¢/ã‚¿ã‚°/ã‚¿ãƒ–ï¼ˆURLåŒæœŸãƒ»A11yï¼‰ï¼»2025-08 è¿½åŠ ï¼½
 - âœ… ãƒ¬ãƒƒã‚¹ãƒ³ã‚«ãƒ¼ãƒ‰å…±é€šåŒ–ï¼ˆé€²æ—ãƒªãƒ³ã‚°/TEST CTA/ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¤ãƒ³æ¼”å‡ºï¼‰ï¼»2025-08 è¿½åŠ ï¼½

### **è„³ç§‘å­¦çš„æ©Ÿèƒ½ï¼ˆSRS: é–“éš”åå¾©å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ï¼‰**

#### **é–“éš”åå¾©ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°**
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è§£ç­”å±¥æ­´ï¼ˆæ­£èª¤ï¼‰ã«åŸºã¥ãã€å„å•é¡Œã®æœ€é©ãªå¾©ç¿’ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¨ˆç®—ï¼ˆç°¡ç•¥ç‰ˆSM-2ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒ™ãƒ¼ã‚¹ï¼‰
- âœ… å¾©ç¿’é–“éš”ã¯å¾ã€…ã«åºƒã’ã¦ã„ãï¼ˆä¾‹: 1æ—¥å¾Œ, 3æ—¥å¾Œ, 7æ—¥å¾Œ, 16æ—¥å¾Œ...ï¼‰
- âœ… `user_question_srs_status` ãƒ†ãƒ¼ãƒ–ãƒ«ã§ç®¡ç†

#### **å¾©ç¿’å•é¡Œã®æç¤º**
- âœ… ï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼‰ã€Œä»Šæ—¥ã®å¾©ç¿’ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã€å¾©ç¿’æ™‚æœŸãŒæ¥ãŸå•é¡Œã®é€šçŸ¥
- âœ… å­¦ç¿’ã‚»ãƒƒã‚·ãƒ§ãƒ³å†…ã§ã€å¾©ç¿’å¯¾è±¡ã®å•é¡Œã‚’å„ªå…ˆçš„ã«å‡ºé¡Œ

### **AIãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºæ©Ÿèƒ½**

#### **è‹¦æ‰‹ã‚«ãƒ†ã‚´ãƒªæ¨è–¦**
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è§£ç­”å±¥æ­´ã‹ã‚‰ã€ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®æ­£ç­”ç‡ã¨è§£ç­”æ•°ã‚’é›†è¨ˆ
- âœ… æ­£ç­”ç‡ãŒä¸€å®šä»¥ä¸‹ï¼ˆä¾‹: 60%ï¼‰ã‹ã¤è§£ç­”æ•°ãŒä¸€å®šä»¥ä¸Šï¼ˆä¾‹: 10å•ï¼‰ã®ã‚«ãƒ†ã‚´ãƒªã‚’ã€Œè‹¦æ‰‹ã‚«ãƒ†ã‚´ãƒªã€ã¨ã—ã¦åˆ¤å®š
- âœ… ï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼‰è‹¦æ‰‹ã‚«ãƒ†ã‚´ãƒªã‚’ã„ãã¤ã‹æ¨è–¦ã—ã€å­¦ç¿’ã‚’ä¿ƒã™

#### **å­¦ç¿’çŠ¶æ³ã®å¯è¦–åŒ–**
- âœ… ï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼‰ã‚«ãƒ†ã‚´ãƒªåˆ¥æ­£ç­”ç‡ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ
- âœ… ï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼‰å…¨ä½“çš„ãªå­¦ç¿’é€²æ—ã‚µãƒãƒªãƒ¼

---

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### **ERå›³ï¼ˆMermaidï¼‰**

```mermaid
erDiagram
    profiles {
        uuid id PK
        text username
        text full_name
        text email
        timestamptz updated_at
        text avatar_url
        text website
        text roll
        timestamptz created_at
    }

    question_categories {
        uuid id PK
        text name
        uuid user_id FK "nullable"
        timestamptz created_at
        timestamptz updated_at
    }

    card_decks {
        uuid id PK
        uuid user_id FK
        uuid category_id FK
        text title
        text description "nullable"
        timestamptz created_at
        timestamptz updated_at
    }

    questions {
        uuid id PK
        uuid deck_id FK
        text question_text
        text[] options
        smallint correct_option_index
        text explanation "nullable"
        text explanation_image_url "nullable"
        text difficulty_level
        timestamptz created_at
        timestamptz updated_at
    }

    learning_records {
        uuid id PK
        uuid user_id FK
        uuid question_id FK
        integer attempt_number
        timestamptz attempt_date
        boolean is_correct
        integer response_time_ms "nullable"
        text marked_status "nullable"
        timestamptz created_at
    }

    user_question_srs_status {
        uuid user_id PK_FK
        uuid question_id PK_FK
        timestamptz next_review_date "nullable"
        integer interval_days "nullable"
        real ease_factor "nullable"
        integer repetitions "nullable"
        uuid last_attempt_record_id FK "nullable"
        timestamptz updated_at
    }

    unified_cpl_questions {
        uuid id PK
        text main_subject
        text sub_subject
        text question_text
        jsonb options
        int correct_answer
        text explanation
        int difficulty_level
        timestamptz created_at
        timestamptz updated_at
    }

    quiz_sessions {
        uuid id PK
        uuid user_id FK
        text session_type
        jsonb settings
        jsonb answers
        numeric score_percentage
        timestamptz created_at
        timestamptz updated_at
    }

    user_test_results {
        uuid id PK
        uuid user_id FK
        uuid question_id FK
        int user_answer
        int correct_answer
        bool is_correct
        int response_time_seconds
        timestamptz created_at
    }

    profiles ||--o{ card_decks : "creates"
    profiles ||--o{ learning_records : "has_attempts_for"
    profiles ||--o{ user_question_srs_status : "has_srs_status_for"
    profiles ||--o{ question_categories : "can_create_custom"

    question_categories ||--o{ card_decks : "belongs_to"
    card_decks ||--o{ questions : "contains"
    questions ||--o{ learning_records : "is_attempt_of"
    questions ||--o{ user_question_srs_status : "has_srs_status_for_question"
    learning_records }o..o| user_question_srs_status : "updates_srs_via"
```

### **ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©**

#### **profiles ãƒ†ãƒ¼ãƒ–ãƒ«**
```sql
-- Supabase Authã®usersãƒ†ãƒ¼ãƒ–ãƒ«ã¨é€£æº
CREATE TABLE profiles (
  id uuid REFERENCES auth.users(id) ON DELETE CASCADE PRIMARY KEY,
  updated_at timestamp with time zone DEFAULT timezone('utc'::text, now()) NOT NULL,
  username text UNIQUE,
  full_name text,
  avatar_url text,
  email text,
  roll text DEFAULT 'student'::text
);
```

#### **question_categories ãƒ†ãƒ¼ãƒ–ãƒ«**
```sql
CREATE TABLE question_categories (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  name varchar(255) NOT NULL,
  description text,
  parent_category_id uuid REFERENCES question_categories(id),
  display_order integer DEFAULT 0,
  created_at timestamp DEFAULT now(),
  updated_at timestamp DEFAULT now()
);
```

#### **card_decks ãƒ†ãƒ¼ãƒ–ãƒ«**
```sql
CREATE TABLE card_decks (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  name varchar(255) NOT NULL,
  description text,
  category_id uuid REFERENCES question_categories(id),
  difficulty_level integer DEFAULT 1,
  is_active boolean DEFAULT true,
  created_by uuid REFERENCES profiles(id),
  created_at timestamp DEFAULT now(),
  updated_at timestamp DEFAULT now()
);
```

#### **questions ãƒ†ãƒ¼ãƒ–ãƒ«**
```sql
CREATE TABLE questions (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  deck_id uuid REFERENCES card_decks(id) ON DELETE CASCADE,
  question_text text NOT NULL,
  option_a text NOT NULL,
  option_b text NOT NULL,
  option_c text NOT NULL,
  option_d text NOT NULL,
  correct_answer char(1) NOT NULL CHECK (correct_answer IN ('A', 'B', 'C', 'D')),
  explanation text,
  difficulty_level integer DEFAULT 1,
  tags text[],
  image_urls text[],
  created_at timestamp DEFAULT now(),
  updated_at timestamp DEFAULT now()
);
```

#### **learning_records ãƒ†ãƒ¼ãƒ–ãƒ«**
```sql
CREATE TABLE learning_records (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id uuid REFERENCES profiles(id) ON DELETE CASCADE,
  question_id uuid REFERENCES questions(id) ON DELETE CASCADE,
  user_answer char(1) CHECK (user_answer IN ('A', 'B', 'C', 'D')),
  is_correct boolean,
  answer_time_seconds integer,
  session_id uuid,
  created_at timestamp DEFAULT now()
);
```

#### **user_question_srs_status ãƒ†ãƒ¼ãƒ–ãƒ«**
```sql
CREATE TABLE user_question_srs_status (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id uuid REFERENCES profiles(id) ON DELETE CASCADE,
  question_id uuid REFERENCES questions(id) ON DELETE CASCADE,
  ease_factor real DEFAULT 2.5,
  interval_days integer DEFAULT 1,
  repetitions integer DEFAULT 0,
  next_review_date date DEFAULT CURRENT_DATE,
  last_review_date date,
  created_at timestamp DEFAULT now(),
  updated_at timestamp DEFAULT now(),
  UNIQUE(user_id, question_id)
);
```

---

## ğŸŒ APIä»•æ§˜

### **èªè¨¼ï¼ˆSupabase Authï¼‰**

FlightAcademyTsxã§ã¯ã€Supabaseã®çµ„ã¿è¾¼ã¿èªè¨¼æ©Ÿèƒ½ã‚’å…¨é¢çš„ã«åˆ©ç”¨ã—ã¾ã™ã€‚

#### **å¯¾å¿œãƒ•ãƒ­ãƒ¼**
- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—
- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ã‚µã‚¤ãƒ³ã‚¤ãƒ³
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆï¼ˆMagic Link ã¾ãŸã¯ ç¢ºèªãƒ¡ãƒ¼ãƒ«çµŒç”±ï¼‰
- ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆJWTãƒ™ãƒ¼ã‚¹ã€Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒè‡ªå‹•å‡¦ç†ï¼‰

### **RPCï¼ˆRemote Procedure Callï¼‰é–¢æ•°**

#### **get_quiz_session**

**ç›®çš„**: æŒ‡å®šã•ã‚ŒãŸã‚«ãƒ¼ãƒ‰ãƒ‡ãƒƒã‚­ã‹ã‚‰ã€å­¦ç¿’ã‚»ãƒƒã‚·ãƒ§ãƒ³ç”¨ã®å•é¡Œç¾¤ã‚’å–å¾—ã™ã‚‹ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
- `p_deck_id` (uuid): å¯¾è±¡ã®ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒƒã‚­ID
- `p_user_id` (uuid): ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
- `p_num_questions` (integer): å–å¾—ã™ã‚‹å•é¡Œæ•°

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
[
  {
    "question_id": "uuid",
    "question_text": "string",
    "options": ["string", "string", "string", "string"],
    "difficulty_level": "string"
  }
]
```

**ãƒ­ã‚¸ãƒƒã‚¯æ¦‚è¦**:
1. `p_user_id` ã¨ `p_deck_id` ã«ç´ã¥ãå•é¡Œã‚’å–å¾—
2. `user_question_srs_status` ã‚’å‚ç…§ã—ã€`next_review_date` ãŒä»Šæ—¥ä»¥å‰ã®å•é¡Œã‚’å„ªå…ˆãƒªã‚¹ãƒˆã«è¿½åŠ 
3. ã¾ã ä¸€åº¦ã‚‚è§£ç­”ã—ã¦ã„ãªã„å•é¡Œã‚’ãƒªã‚¹ãƒˆã«è¿½åŠ 
4. `p_num_questions` åˆ†ã®å•é¡Œã‚’é¸æŠã—ã¦è¿”ã™

#### **submit_answer**

**ç›®çš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è§£ç­”ã‚’è¨˜éŒ²ã—ã€SRSæƒ…å ±ã‚’æ›´æ–°ã™ã‚‹ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
- `p_user_id` (uuid): ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
- `p_question_id` (uuid): è§£ç­”ã—ãŸå•é¡ŒID
- `p_is_correct` (boolean): è§£ç­”ãŒæ­£è§£ã ã£ãŸã‹ã©ã†ã‹
- `p_response_time_ms` (integer): è§£ç­”ã«ã‹ã‹ã£ãŸæ™‚é–“ï¼ˆãƒŸãƒªç§’ï¼‰
- `p_marked_status` (text): ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä»˜ä¸ã—ãŸãƒãƒ¼ã‚¯çŠ¶æ…‹

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
{
  "learning_record_id": "uuid",
  "srs_status_updated": true,
  "next_review_date": "timestamp with time zone",
  "correct_option_index": "smallint",
  "explanation": "string",
  "explanation_image_url": "string"
}
```

#### **get_review_questions**

**ç›®çš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä»Šæ—¥ã¾ãŸã¯ãã‚Œä»¥å‰ã«å¾©ç¿’ã™ã¹ãå•é¡Œã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã™ã‚‹ï¼ˆSRSã«åŸºã¥ãï¼‰ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
- `p_user_id` (uuid): ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
- `p_limit` (integer): å–å¾—ã™ã‚‹æœ€å¤§å•é¡Œæ•°

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
[
  {
    "question_id": "uuid",
    "question_text": "string",
    "options": ["string", "string", "string", "string"],
    "difficulty_level": "string",
    "deck_id": "uuid",
    "deck_title": "string"
  }
]
```

#### **get_recommended_categories**

**ç›®çš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è‹¦æ‰‹ãªå¯èƒ½æ€§ã®ã‚ã‚‹å•é¡Œã‚«ãƒ†ã‚´ãƒªã‚’æ¨è–¦ã™ã‚‹ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
- `p_user_id` (uuid): ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
- `p_threshold_correct_rate` (real): æ­£ç­”ç‡ã®é–¾å€¤
- `p_min_attempts` (integer): ã‚«ãƒ†ã‚´ãƒªã‚’ãŠã™ã™ã‚ã™ã‚‹ãŸã‚ã®æœ€å°è§£ç­”æ•°
- `p_recommend_limit` (integer): æ¨è–¦ã™ã‚‹ã‚«ãƒ†ã‚´ãƒªã®æœ€å¤§æ•°

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
[
  {
    "category_id": "uuid",
    "category_name": "string",
    "correct_rate": "real",
    "total_attempts": "integer"
  }
]
```

#### **import_deck_from_csv**

**ç›®çš„**: CSVãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ–°ã—ã„ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒƒã‚­ã¨å•é¡Œã‚’ä¸€æ‹¬ã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
- `p_user_id` (uuid): ãƒ‡ãƒƒã‚­ä½œæˆè€…ã¨ãªã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼ˆAdminæ¨©é™ãŒå¿…è¦ï¼‰
- `p_deck_title` (text): ä½œæˆã™ã‚‹ãƒ‡ãƒƒã‚­ã®ã‚¿ã‚¤ãƒˆãƒ«
- `p_category_name` (text): ç´ä»˜ã‘ã‚‹ã‚«ãƒ†ã‚´ãƒªå
- `p_csv_data` (text): CSVå½¢å¼ã®æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿

**CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**:
```
question_text,option1,option2,option3,option4,correct_option_index,explanation,difficulty_level
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
{
  "deck_id": "uuid",
  "questions_imported_count": "integer"
}
```

#### **get_category_performance_stats**

**ç›®çš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚«ãƒ†ã‚´ãƒªåˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼ˆè§£ç­”æ•°ã€æ­£è§£æ•°ã€æ­£ç­”ç‡ï¼‰ã‚’å–å¾—ã—ã€ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤ºãªã©ã«åˆ©ç”¨ã™ã‚‹ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
- `p_user_id` (uuid): ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
- `p_target_categories` (text[]): å¯¾è±¡ã¨ã™ã‚‹ã‚«ãƒ†ã‚´ãƒªåã®é…åˆ—

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
[
  {
    "category_id": "uuid",
    "category_name": "string",
    "total_questions_in_category": "integer",
    "attempted_questions": "integer",
    "correct_answers": "integer",
    "total_attempts_in_category": "integer",
    "accuracy": "real"
  }
]
```

### **RLSï¼ˆRow Level Securityï¼‰ãƒãƒªã‚·ãƒ¼**

#### **åŸºæœ¬æ–¹é‡**
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªèº«ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆprofile, learning_records, user_question_srs_status, ä½œæˆã—ãŸdecks/categories/questionsï¼‰ã®ã¿ãƒ•ãƒ«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- å…¬é–‹æƒ…å ±ï¼ˆå…±é€šã‚«ãƒ†ã‚´ãƒªã€ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã—ãŸå…¬é–‹ãƒ‡ãƒƒã‚­ãªã©ï¼‰ã¯èª­ã¿å–ã‚Šå¯èƒ½
- Teacherã¯æ‹…å½“Studentã®å­¦ç¿’è¨˜éŒ²ã‚’èª­ã¿å–ã‚Šå¯èƒ½
- Adminã¯ã»ã¼å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿æ›¸ãå¯èƒ½

#### **ãƒãƒªã‚·ãƒ¼ä¾‹**

**profiles ãƒ†ãƒ¼ãƒ–ãƒ«**:
```sql
-- ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿å–ã‚Šï¼ˆè‡ªåˆ†ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ï¼‰
CREATE POLICY "Users can view own profile" ON profiles
FOR SELECT USING (auth.uid() = id);

-- ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°ï¼ˆè‡ªåˆ†ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ï¼‰
CREATE POLICY "Users can update own profile" ON profiles
FOR UPDATE USING (auth.uid() = id);
```

**learning_records ãƒ†ãƒ¼ãƒ–ãƒ«**:
```sql
-- å­¦ç¿’è¨˜éŒ²èª­ã¿å–ã‚Šï¼ˆè‡ªåˆ†ã®è¨˜éŒ²ã®ã¿ã€ã¾ãŸã¯Admin/Teacherï¼‰
CREATE POLICY "Users can view own learning records" ON learning_records
FOR SELECT USING (
  auth.uid() = user_id OR
  EXISTS (
    SELECT 1 FROM profiles
    WHERE id = auth.uid()
    AND roll IN ('admin', 'teacher')
  )
);

-- å­¦ç¿’è¨˜éŒ²æŒ¿å…¥ï¼ˆè‡ªåˆ†ã®è¨˜éŒ²ã®ã¿ï¼‰
CREATE POLICY "Users can insert own learning records" ON learning_records
FOR INSERT WITH CHECK (auth.uid() = user_id);
```

---

## ğŸ¨ UI/UXä»•æ§˜

### **ãƒ˜ãƒƒãƒ€ãƒ¼/ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ›´æ–°ï¼‰**
- æ—§: LESSONS ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã«ã‚ˆã‚‹ã‚«ãƒ†ã‚´ãƒªé·ç§»
- æ–°: LESSONS ã¯ `/learning` ã¸ã®ãƒªãƒ³ã‚¯ã®ã¿ã€‚ãƒšãƒ¼ã‚¸å†…ã‚¿ãƒ–/æ¤œç´¢ã§è£œå®Œï¼ˆ2025-08ï¼‰
- è¿½åŠ : `HOME`ï¼ˆ`/`ï¼‰ãƒªãƒ³ã‚¯ã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆPC/ãƒ¢ãƒã‚¤ãƒ«ï¼‰ã«è¿½åŠ ï¼ˆ2025-09ï¼‰
- å¤‰æ›´: `PLANNING` ã¯ `/planning` ã¸é·ç§»ï¼ˆ2025-09ï¼‰

#### **ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆæ›´æ–°: 2025-09ï¼‰**
- `/` â†’ `HomePage`ï¼ˆãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°/ç™»éŒ²CTAï¼‰
- `/planning` â†’ `PlanningMapPage`ï¼ˆæ—§ãƒˆãƒƒãƒ—ï¼‰
- `AuthPage` ã¯ `?mode=signup|reset` ã‚¯ã‚¨ãƒªã§åˆæœŸãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿

### **å…¨ä½“çš„ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼**

#### **æ–°è¦ç™»éŒ²ãƒ•ãƒ­ãƒ¼**
```mermaid
flowchart TD
    A[ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸] --> B[æ–°è¦ç™»éŒ²ç”»é¢]
    B --> C[ãƒ¡ãƒ¼ãƒ«èªè¨¼]
    C --> D[ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®š]
    D --> E[ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰]
```

#### **ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼**
```mermaid
flowchart TD
    A[ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸] --> B[ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢]
    B --> C{èªè¨¼æˆåŠŸ?}
    C -->|Yes| D[ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰]
    C -->|No| E[ã‚¨ãƒ©ãƒ¼è¡¨ç¤º]
    E --> B
```

#### **æ¨™æº–å­¦ç¿’ãƒ•ãƒ­ãƒ¼**
```mermaid
flowchart TD
    A[ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰] --> B[ã‚«ãƒ†ã‚´ãƒªé¸æŠ]
    B --> C[ãƒ‡ãƒƒã‚­é¸æŠ]
    C --> D[å•é¡Œè§£ç­”ç”»é¢]
    D --> E[ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¡¨ç¤º]
    E --> F{ç¶šè¡Œ?}
    F -->|Yes| D
    F -->|No| G[çµæœç”»é¢]
    G --> A
```

### **ä¸»è¦ç”»é¢è¨­è¨ˆ**

#### **A. èªè¨¼é–¢é€£ç”»é¢**

**ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢**
- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³
- æ–°è¦ç™»éŒ²ãƒªãƒ³ã‚¯
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒªãƒ³ã‚¯

**æ–°è¦ç™»éŒ²ç”»é¢**
- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼åå…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- ç™»éŒ²ãƒœã‚¿ãƒ³
- ãƒ­ã‚°ã‚¤ãƒ³ãƒªãƒ³ã‚¯

#### **B. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”»é¢**

**ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ§‹æˆ**:
- ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼‰
- å­¦ç¿’çµ±è¨ˆã‚µãƒãƒªãƒ¼ï¼ˆç·å­¦ç¿’å•é¡Œæ•°ã€å¹³å‡æ­£è§£ç‡ã€å­¦ç¿’æ—¥æ•°ï¼‰
- ã‚«ãƒ†ã‚´ãƒªåˆ¥æ­£ç­”ç‡ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ
- ä»Šæ—¥ã®å¾©ç¿’ã‚»ã‚¯ã‚·ãƒ§ãƒ³
- è‹¦æ‰‹ã‚«ãƒ†ã‚´ãƒªæ¨è–¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³
- ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ãƒœã‚¿ãƒ³ï¼ˆå­¦ç¿’é–‹å§‹ã€å±¥æ­´ç¢ºèªï¼‰

#### **C. ãƒ‡ãƒƒã‚­ä¸€è¦§ãƒ»é¸æŠç”»é¢**

**æ©Ÿèƒ½è¦ç´ **:
- ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- ãƒ‡ãƒƒã‚­ã‚«ãƒ¼ãƒ‰ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ã€å•é¡Œæ•°ã€é›£æ˜“åº¦ï¼‰
- æ¤œç´¢æ©Ÿèƒ½
- ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆåå‰é †ã€é›£æ˜“åº¦é †ã€æœ€è¿‘ã®å­¦ç¿’é †ï¼‰

#### **D. å•é¡Œè§£ç­”ç”»é¢**

**ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¦ç´ **:
- é€²æ—è¡¨ç¤ºï¼ˆå•é¡Œç•ªå·/ç·å•é¡Œæ•°ï¼‰
- ã‚¿ã‚¤ãƒãƒ¼è¡¨ç¤º
- å•é¡Œæ–‡
- 4æŠé¸æŠè‚¢ï¼ˆãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ï¼‰
- è§£ç­”ãƒœã‚¿ãƒ³
- ãƒãƒ¼ã‚¯æ©Ÿèƒ½ãƒœã‚¿ãƒ³ï¼ˆãƒã‚§ãƒƒã‚¯ã€ã‚ã‹ã‚‰ãªã„ï¼‰
- å‰ã®å•é¡Œ/æ¬¡ã®å•é¡Œãƒœã‚¿ãƒ³

**ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¡¨ç¤º**:
- æ­£èª¤åˆ¤å®š
- æ­£è§£ã®é¸æŠè‚¢ãƒã‚¤ãƒ©ã‚¤ãƒˆ
- è§£èª¬æ–‡
- è§£èª¬ç”»åƒï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰
- æ¬¡ã®å•é¡Œãƒœã‚¿ãƒ³

#### **E. å­¦ç¿’çµæœç”»é¢**

**è¡¨ç¤ºè¦ç´ **:
- ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ±è¨ˆï¼ˆæ­£è§£æ•°/å•é¡Œæ•°ã€æ­£ç­”ç‡ã€çµŒéæ™‚é–“ï¼‰
- é–“é•ãˆãŸå•é¡Œã®ä¸€è¦§
- ã‚«ãƒ†ã‚´ãƒªåˆ¥æ­£ç­”ç‡
- å¾©ç¿’æ¨å¥¨å•é¡Œ
- ã‚‚ã†ä¸€åº¦å­¦ç¿’ãƒœã‚¿ãƒ³
- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹ãƒœã‚¿ãƒ³

#### **F. å•é¡Œç®¡ç†ç”»é¢ï¼ˆAdminï¼‰**

**æ©Ÿèƒ½ä¸€è¦§**:
- å•é¡Œä¸€è¦§è¡¨ç¤ºï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã€æ¤œç´¢ï¼‰
- å•é¡Œä½œæˆãƒ•ã‚©ãƒ¼ãƒ 
- å•é¡Œç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ 
- CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½
- ã‚«ãƒ†ã‚´ãƒªç®¡ç†
- ãƒ‡ãƒƒã‚­ç®¡ç†

### **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³å¯¾å¿œ**

#### **ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆ**
- **ãƒ¢ãƒã‚¤ãƒ«**: < 768px
- **ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ**: 768px - 1024px
- **ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—**: > 1024px

#### **ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–**
- ã‚¿ãƒƒãƒãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒœã‚¿ãƒ³ã‚µã‚¤ã‚º
- ã‚¹ãƒ¯ã‚¤ãƒ—ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ï¼ˆå•é¡Œé€ã‚Šï¼‰
- ç¸¦ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–
- ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼

---

## ğŸ”’ éæ©Ÿèƒ½è¦ä»¶

### **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**
- å•é¡Œè¡¨ç¤ºã€è§£ç­”é€ä¿¡ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ã¯1ç§’ä»¥å†…
- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºã¯2ç§’ä»¥å†…
- åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°50äººç¨‹åº¦ã‚’æƒ³å®šï¼ˆåˆæœŸï¼‰

### **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**
- âœ… Supabase RLSï¼ˆRow Level Securityï¼‰ã‚’æ´»ç”¨ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’å¾¹åº•
- âœ… ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯é©åˆ‡ã«ãƒãƒƒã‚·ãƒ¥åŒ–ï¼ˆSupabase Authæ¨™æº–ï¼‰
- å€‹äººæƒ…å ±ä¿è­·ã«é–¢ã™ã‚‹é…æ…®

### **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£**
- ç›´æ„Ÿçš„ã§åˆ†ã‹ã‚Šã‚„ã™ã„UIãƒ‡ã‚¶ã‚¤ãƒ³
- ãƒ¢ãƒã‚¤ãƒ«ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
- ä¸»è¦ãªæ“ä½œã¯3ã‚¯ãƒªãƒƒã‚¯ä»¥å†…ã§åˆ°é”å¯èƒ½ï¼ˆåŠªåŠ›ç›®æ¨™ï¼‰
- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ï¼ˆWCAGæ¨™æº–ãªã©ï¼‰ã¸ã®é…æ…®ï¼ˆå°†æ¥æ¤œè¨ï¼‰

### **ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§**
- âœ… ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ã€ä¿å®ˆæ€§ã‚’é«˜ã‚ã‚‹ãŸã‚TypeScriptã‚’æ¡ç”¨
- âœ… ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ™ãƒ¼ã‚¹ã®UIæ§‹ç¯‰ï¼ˆReactï¼‰
- é©åˆ‡ãªã‚³ãƒ¡ãƒ³ãƒˆã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- å¤‰æ›´å®¹æ˜“æ€§ã€ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§

### **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**
- âœ… Supabaseã®BaaSã¨ã—ã¦ã®ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã‚’æ´»ç”¨
- å°†æ¥çš„ãªãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ãƒ»ãƒ‡ãƒ¼ã‚¿é‡å¢—åŠ ã«å¯¾å¿œã§ãã‚‹è¨­è¨ˆã‚’æ„è­˜

### **ä¿¡é ¼æ€§ãƒ»å¯ç”¨æ€§**
- âœ… ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆVercel/Firebaseï¼‰ã®SLAã«æº–æ‹ 
- å®šæœŸçš„ãªãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆSupabaseæ¨™æº–æ©Ÿèƒ½ï¼‰

---

## ğŸ“ˆ å®Ÿè£…å„ªå…ˆåº¦ã¨é€²æ—

### **Phase 1: åŸºç›¤æ§‹ç¯‰ï¼ˆå®Œäº†ï¼‰**
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- âœ… åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ
- âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®ç¢ºç«‹

### **Phase 2: ã‚³ã‚¢æ©Ÿèƒ½å®Ÿè£…ï¼ˆå®Œäº†ï¼‰**
- âœ… å•é¡Œã‚«ãƒ†ã‚´ãƒªãƒ»ãƒ‡ãƒƒã‚­ç®¡ç†
- âœ… 4æŠå•é¡Œã‚·ã‚¹ãƒ†ãƒ 
- âœ… åŸºæœ¬çš„ãªå­¦ç¿’è¨˜éŒ²

### **Phase 3: å­¦ç¿’æ”¯æ´æ©Ÿèƒ½ï¼ˆé€²è¡Œä¸­ï¼‰**
- âœ… SRSï¼ˆé–“éš”åå¾©å­¦ç¿’ï¼‰ã‚·ã‚¹ãƒ†ãƒ 
- âœ… ã‚¿ã‚¤ãƒãƒ¼æ©Ÿèƒ½
- âœ… å¾©ç¿’æ©Ÿèƒ½
- ğŸ”„ AIãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºæ©Ÿèƒ½

### **Phase 4: ç®¡ç†æ©Ÿèƒ½ï¼ˆè¨ˆç”»ä¸­ï¼‰**
- ğŸ”„ Adminå‘ã‘å•é¡Œç®¡ç†ç”»é¢
- ğŸ”„ CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½
- ğŸ”„ å­¦ç¿’åˆ†ææ©Ÿèƒ½

### **Phase 5: æ‹¡å¼µæ©Ÿèƒ½ï¼ˆå°†æ¥ï¼‰**
- ğŸ”„ ãƒ‡ã‚¤ãƒªãƒ¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸
- ğŸ”„ å ±é…¬ãƒ»ãƒãƒƒã‚¸ã‚·ã‚¹ãƒ†ãƒ 
- ğŸ”„ ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ¢ãƒ¼ãƒ‰

---

## âœˆï¸ Flight Planningæ©Ÿèƒ½è¨­è¨ˆ

### **æ¦‚è¦**

Flight Planningæ©Ÿèƒ½ã¯ã€èˆªç©ºæ©Ÿã®é£›è¡Œè¨ˆç”»ã‚’ä½œæˆãƒ»ç®¡ç†ã™ã‚‹ãŸã‚ã®åŒ…æ‹¬çš„ãªã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚å‡ºç™ºåœ°ãƒ»ç›®çš„åœ°ã®è¨­å®šã€çµŒè·¯ä¸Šã®ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆè¿½åŠ ã€NAVAIDã‹ã‚‰ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè¨ˆç®—ã€é£›è¡Œæ™‚é–“ãƒ»è·é›¢ã®è‡ªå‹•è¨ˆç®—ãªã©ã‚’æä¾›ã—ã¾ã™ã€‚

### **ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**

#### **RoutePlanningï¼ˆçµŒè·¯è¨ˆç”»ï¼‰**
```typescript
interface RoutePlanningProps {
  flightPlan: FlightPlan;
  setFlightPlan: React.Dispatch<React.SetStateAction<FlightPlan>>;
  airportOptions: AirportGroupOption[];
  navaidOptions: NavaidOption[];
  selectedNavaid: NavaidOption | null;
  setSelectedNavaid: React.Dispatch<React.SetStateAction<NavaidOption | null>>;
  waypointOptions: WaypointOption[]; // â­è¿½åŠ  (2025å¹´10æœˆ13æ—¥)
  selectedWaypoint: WaypointOption | null; // â­è¿½åŠ  (2025å¹´10æœˆ13æ—¥)
  setSelectedWaypoint: React.Dispatch<React.SetStateAction<WaypointOption | null>>; // â­è¿½åŠ  (2025å¹´10æœˆ13æ—¥)
}
```

**æ©Ÿèƒ½**:
- å‡ºç™ºç©ºæ¸¯ãƒ»åˆ°ç€ç©ºæ¸¯ã®é¸æŠï¼ˆreact-selectä½¿ç”¨ï¼‰
- NAVAIDã®é¸æŠã¨è¿½åŠ 
- Waypointã®é¸æŠã¨è¿½åŠ  â­NEW (2025å¹´10æœˆ13æ—¥)
- ç·¯åº¦çµŒåº¦ã«ã‚ˆã‚‹ã‚«ã‚¹ã‚¿ãƒ ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆè¿½åŠ 
- ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆãƒªã‚¹ãƒˆã®è¡¨ç¤ºãƒ»ç·¨é›†ãƒ»ä¸¦ã¹æ›¿ãˆ

#### **NavaidSelectorï¼ˆNAVAIDé¸æŠï¼‰**
```typescript
interface NavaidSelectorProps {
  options: NavaidOption[];
  selectedNavaid: NavaidOption | null;
  setSelectedNavaid: React.Dispatch<React.SetStateAction<NavaidOption | null>>;
  onAdd: (waypoint: Waypoint) => void;
}
```

**æ©Ÿèƒ½**:
- NAVAIDã®é¸æŠï¼ˆVORã€TACANã€VORTACï¼‰
- ç£æ–¹ä½ï¼ˆ0-360åº¦ï¼‰ã®å…¥åŠ›
- è·é›¢ï¼ˆæµ·é‡Œï¼‰ã®å…¥åŠ›
- ã‚ªãƒ•ã‚»ãƒƒãƒˆåœ°ç‚¹ã®è‡ªå‹•è¨ˆç®—ã¨è¿½åŠ 

**é‡è¦ãªå®Ÿè£…**:
```typescript
const handleAddWaypoint = () => {
  // ç£æ–¹ä½ã¨è·é›¢ã‹ã‚‰ã‚ªãƒ•ã‚»ãƒƒãƒˆåœ°ç‚¹ã‚’è¨ˆç®—
  const offset = calculateOffsetPoint(
    selectedNavaid.latitude,
    selectedNavaid.longitude,
    parseFloat(bearing),
    parseFloat(distance)
  );

  // è¨ˆç®—ã•ã‚ŒãŸã‚ªãƒ•ã‚»ãƒƒãƒˆåº§æ¨™ã‚’ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ç™»éŒ²
  const waypoint: Waypoint = {
    coordinates: [offset.lon, offset.lat], // GeoJSON format
    latitude: offset.lat,
    longitude: offset.lon,
    metadata: {
      baseNavaid: selectedNavaid.name,
      bearing: parseFloat(bearing),
      distance: parseFloat(distance),
      baseLatitude: selectedNavaid.latitude,
      baseLongitude: selectedNavaid.longitude
    }
  };
};
```

#### **WaypointSelectorï¼ˆWaypointé¸æŠï¼‰** â­NEW (2025å¹´10æœˆ13æ—¥è¿½åŠ )
```typescript
interface WaypointSelectorProps {
  options: WaypointOption[];
  selectedWaypoint: WaypointOption | null;
  setSelectedWaypoint: React.Dispatch<React.SetStateAction<WaypointOption | null>>;
  onAdd: (waypoint: Waypoint) => void;
  flightPlan: FlightPlan;
}
```

**æ©Ÿèƒ½**:
- æ—¥æœ¬å…¨å›½ã®Waypointï¼ˆå ±å‘Šç‚¹ï¼‰ã®é¸æŠï¼ˆç´„246KBã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ¤œç´¢å¯èƒ½ï¼‰
- é¸æŠã—ãŸWaypointã®è©³ç´°æƒ…å ±è¡¨ç¤ºï¼š
  - IDã€åå‰ã€ã‚¿ã‚¤ãƒ—ï¼ˆNon-Compulsoryãªã©ï¼‰
  - ç·¯åº¦ãƒ»çµŒåº¦ï¼ˆDMSå½¢å¼ï¼‰
  - å‰ã®ãƒã‚¤ãƒ³ãƒˆï¼ˆå‡ºç™ºåœ°ã¾ãŸã¯æœ€å¾Œã®ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆï¼‰ã‹ã‚‰ã®ç£æ–¹ä½ãƒ»è·é›¢
  - åˆ°ç€åœ°ã¾ã§ã®ç£æ–¹ä½ãƒ»è·é›¢ï¼ˆåˆ°ç€åœ°è¨­å®šæ™‚ï¼‰
- Waypointã®ç›´æ¥è¿½åŠ ï¼ˆã‚ªãƒ•ã‚»ãƒƒãƒˆè¨ˆç®—ä¸è¦ï¼‰

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**:
- `/geojson/Waypoints.json` (GeoJSON FeatureCollectionå½¢å¼ã€ç´„246KB)
- å„Waypoint: `{ properties: { id, type, name1 }, geometry: { coordinates: [lon, lat] } }`

**è¡¨ç¤ºæƒ…å ±ã®è¨ˆç®—**:
```typescript
// å‰ã®ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰ã®ç£æ–¹ä½ãƒ»è·é›¢è¨ˆç®—
const calculateFromPrevious = () => {
  let prevPoint = flightPlan.waypoints.length > 0
    ? flightPlan.waypoints[flightPlan.waypoints.length - 1]
    : flightPlan.departure;

  if (!prevPoint) return null;

  return {
    distance: calculateDistance(prevPoint, selectedWaypoint),
    bearing: calculateMagneticBearing(prevPoint, selectedWaypoint)
  };
};

// åˆ°ç€åœ°ã¾ã§ã®ç£æ–¹ä½ãƒ»è·é›¢è¨ˆç®—
const calculateToNext = () => {
  if (!flightPlan.arrival) return null;

  return {
    distance: calculateDistance(selectedWaypoint, flightPlan.arrival),
    bearing: calculateMagneticBearing(selectedWaypoint, flightPlan.arrival)
  };
};
```

**è¿½åŠ ã•ã‚Œã‚‹Waypointæ§‹é€ **:
```typescript
{
  id: selectedWaypoint.value,
  name: selectedWaypoint.name,
  type: 'waypoint',
  coordinates: [selectedWaypoint.longitude, selectedWaypoint.latitude],
  latitude: selectedWaypoint.latitude,
  longitude: selectedWaypoint.longitude,
  nameEditable: true,
  metadata: {
    baseNavaid: selectedWaypoint.name,
    baseLatitude: selectedWaypoint.latitude,
    baseLongitude: selectedWaypoint.longitude
  }
}
```

#### **WaypointFormï¼ˆã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆè¿½åŠ ï¼‰**
```typescript
interface WaypointFormProps {
  flightPlan: FlightPlan;
  setFlightPlan: React.Dispatch<React.SetStateAction<FlightPlan>>;
}
```

**æ©Ÿèƒ½**:
- DMSï¼ˆåº¦åˆ†ç§’ï¼‰å½¢å¼ã§ã®åº§æ¨™å…¥åŠ›
- 10é€²æ•°å½¢å¼ã§ã®åº§æ¨™å…¥åŠ›
- ã‚ªãƒ•ã‚»ãƒƒãƒˆè¨ˆç®—ï¼ˆæ–¹ä½ãƒ»è·é›¢æŒ‡å®šå¯èƒ½ï¼‰
- ã‚«ã‚¹ã‚¿ãƒ ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆã®è¿½åŠ 

**åº§æ¨™å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰**:
- **DMS**: `N334005, E1234005` å½¢å¼
- **Decimal**: `33.667361, 123.668056` å½¢å¼

### **æ¸¬åœ°ç·šè¨ˆç®—ã‚·ã‚¹ãƒ†ãƒ **

#### **calculateOffsetPointé–¢æ•°**
```typescript
/**
 * æŒ‡å®šã•ã‚ŒãŸç·¯åº¦çµŒåº¦ã‹ã‚‰ã€æŒ‡å®šã•ã‚ŒãŸæ–¹ä½ã¨è·é›¢ã ã‘ã‚ªãƒ•ã‚»ãƒƒãƒˆã—ãŸåœ°ç‚¹ã®ç·¯åº¦çµŒåº¦ã‚’è¨ˆç®—ã™ã‚‹
 * @param lat åŸºæº–ç‚¹ã®ç·¯åº¦
 * @param lon åŸºæº–ç‚¹ã®çµŒåº¦
 * @param magneticBearing ç£æ–¹ä½ï¼ˆåº¦ï¼‰
 * @param distanceNM è·é›¢ï¼ˆæµ·é‡Œï¼‰
 * @returns ã‚ªãƒ•ã‚»ãƒƒãƒˆåœ°ç‚¹ã®ç·¯åº¦çµŒåº¦ã€è¨ˆç®—ã‚¨ãƒ©ãƒ¼æ™‚ã¯null
 */
export function calculateOffsetPoint(
  lat: number,
  lon: number,
  magneticBearing: number,
  distanceNM: number
): { lat: number; lon: number } | null
```

**å®Ÿè£…è©³ç´°**:

1. **ç£æ°—åå·®è£œæ­£**
   - æ—¥æœ¬ã®å¹³å‡ç£æ°—åå·®: **8åº¦**
   - çœŸæ–¹ä½ = ç£æ–¹ä½ - ç£æ°—åå·®
   ```typescript
   const MAGNETIC_DECLINATION = 8; // æ—¥æœ¬ã®å¹³å‡ç£æ°—åå·®ï¼ˆåº¦ï¼‰
   const trueBearing = (magneticBearing - MAGNETIC_DECLINATION + 360) % 360;
   ```

2. **å˜ä½å¤‰æ›**
   - 1æµ·é‡Œï¼ˆNMï¼‰= 1852ãƒ¡ãƒ¼ãƒˆãƒ«
   - åœ°çƒåŠå¾„: 6,371,000ãƒ¡ãƒ¼ãƒˆãƒ«
   ```typescript
   const EARTH_RADIUS = 6371000; // ãƒ¡ãƒ¼ãƒˆãƒ«
   const distanceMeters = distanceNM * 1852;
   ```

3. **æ¸¬åœ°ç·šè¨ˆç®—ï¼ˆHaversine Formulaï¼‰**
   ```typescript
   // æ–°ãŸãªç·¯åº¦ï¼ˆãƒ©ã‚¸ã‚¢ãƒ³ï¼‰
   const newLatRad = Math.asin(
     Math.sin(latRad) * Math.cos(distanceMeters / EARTH_RADIUS) +
     Math.cos(latRad) * Math.sin(distanceMeters / EARTH_RADIUS) * Math.cos(bearingRad)
   );

   // æ–°ãŸãªçµŒåº¦ï¼ˆãƒ©ã‚¸ã‚¢ãƒ³ï¼‰
   const newLonRad = lonRad + Math.atan2(
     Math.sin(bearingRad) * Math.sin(distanceMeters / EARTH_RADIUS) * Math.cos(latRad),
     Math.cos(distanceMeters / EARTH_RADIUS) - Math.sin(latRad) * Math.sin(newLatRad)
   );
   ```

4. **ç²¾åº¦ä¿è¨¼**
   - ç·¯åº¦ãƒ»çµŒåº¦: å°æ•°ç‚¹ä»¥ä¸‹6æ¡ï¼ˆç´„0.1ãƒ¡ãƒ¼ãƒˆãƒ«ã®ç²¾åº¦ï¼‰
   - ç£æ°—åå·®: åœ°åŸŸå¹³å‡å€¤ã‚’ä½¿ç”¨
   - åœ°çƒå½¢çŠ¶: çƒä½“è¿‘ä¼¼ï¼ˆå®Ÿç”¨èˆªæ³•ãƒ¬ãƒ™ãƒ«ã§ååˆ†ãªç²¾åº¦ï¼‰

### **ç£æ°—åå·®ã«ã¤ã„ã¦**

#### **æ—¥æœ¬ã«ãŠã‘ã‚‹ç£æ°—åå·®**
- **å¹³å‡å€¤**: è¥¿åç´„8åº¦ï¼ˆ2025å¹´ç¾åœ¨ï¼‰
- **åœ°åŸŸå·®**: åŒ—æµ·é“ï¼ˆ7åº¦ï¼‰ã€œæ²–ç¸„ï¼ˆ9åº¦ï¼‰
- **å¹´å¤‰åŒ–**: ç´„0.1åº¦/å¹´ã§æ±é€²ä¸­

#### **èˆªç©ºèˆªæ³•ã§ã®æ‰±ã„**
- **ç£æ–¹ä½ï¼ˆMagnetic Bearingï¼‰**: ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆãŒä½¿ç”¨ã™ã‚‹æ–¹ä½
- **çœŸæ–¹ä½ï¼ˆTrue Bearingï¼‰**: åœ°å›³ä¸Šã®åŒ—ã‚’åŸºæº–ã¨ã—ãŸæ–¹ä½
- **æ›ç®—å¼**: çœŸæ–¹ä½ = ç£æ–¹ä½ - ç£æ°—åå·®

**ä¾‹**:
```
ç£æ–¹ä½ 030åº¦ â†’ çœŸæ–¹ä½ = 030 - 8 = 022åº¦
ç£æ–¹ä½ 270åº¦ â†’ çœŸæ–¹ä½ = 270 - 8 = 262åº¦
```

#### **å®Ÿè£…ä¸Šã®æ³¨æ„ç‚¹**
1. **åœ°åŸŸåˆ¥è£œæ­£**: ã‚ˆã‚Šé«˜ç²¾åº¦ãŒå¿…è¦ãªå ´åˆã¯åœ°åŸŸåˆ¥åå·®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å®Ÿè£…
2. **å¹´å¤‰åŒ–**: å®šæœŸçš„ãªåå·®å€¤ã®æ›´æ–°ãŒå¿…è¦
3. **ICAOãƒãƒ£ãƒ¼ãƒˆ**: å…¬å¼èˆªç©ºå›³ã®åå·®å€¤ã¨æ•´åˆæ€§ã‚’ä¿ã¤

### **ãƒ‡ãƒ¼ã‚¿å‹å®šç¾©**

#### **Waypointå‹**
```typescript
export interface Waypoint {
  id: string;
  name: string;
  type: 'custom' | 'navaid' | 'airport' | 'waypoint'; // â­'waypoint'è¿½åŠ  (2025å¹´10æœˆ13æ—¥)
  sourceId?: string;
  ch?: string;
  coordinates: [number, number]; // GeoJSON format: [longitude, latitude]
  latitude: number;
  longitude: number;
  nameEditable?: boolean;
  metadata?: WaypointMetadata;
}
```

**ã‚¿ã‚¤ãƒ—èª¬æ˜**:
- `custom`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç·¯åº¦çµŒåº¦ã§ç›´æ¥è¿½åŠ ã—ãŸã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆ
- `navaid`: NAVAIDã‹ã‚‰ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè¨ˆç®—ã§è¿½åŠ ã—ãŸã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆ
- `airport`: ç©ºæ¸¯
- `waypoint`: Waypoints.jsonã‹ã‚‰é¸æŠã—ã¦è¿½åŠ ã—ãŸå ±å‘Šç‚¹ â­NEW

#### **WaypointMetadataå‹**
```typescript
export interface WaypointMetadata {
  baseNavaid: string;        // åŸºæº–ã¨ãªã‚‹NAVAIDåã¾ãŸã¯Waypointå
  bearing?: number;          // ç£æ–¹ä½ï¼ˆåº¦ï¼‰â­ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«åŒ– (2025å¹´10æœˆ13æ—¥)
  distance?: number;         // è·é›¢ï¼ˆæµ·é‡Œï¼‰â­ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«åŒ– (2025å¹´10æœˆ13æ—¥)
  baseLatitude: number;      // åŸºæº–ç‚¹ã®ç·¯åº¦
  baseLongitude: number;     // åŸºæº–ç‚¹ã®çµŒåº¦
}
```

**å¤‰æ›´å†…å®¹** (2025å¹´10æœˆ13æ—¥):
- `bearing`ã¨`distance`ã‚’ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«åŒ–ï¼šWaypointç›´æ¥è¿½åŠ æ™‚ã¯ã‚ªãƒ•ã‚»ãƒƒãƒˆæƒ…å ±ãŒä¸è¦ãªãŸã‚

#### **FlightPlanå‹**
```typescript
export interface FlightPlan {
  departure?: Airport;        // å‡ºç™ºç©ºæ¸¯
  arrival?: Airport;          // åˆ°ç€ç©ºæ¸¯
  waypoints: Waypoint[];      // ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆãƒªã‚¹ãƒˆ
  speed: number;              // é€Ÿåº¦ï¼ˆãƒãƒƒãƒˆï¼‰
  altitude: number;           // é«˜åº¦ï¼ˆãƒ•ã‚£ãƒ¼ãƒˆï¼‰
  departureTime: string;      // å‡ºç™ºæ™‚åˆ»
  groundTempC: number;        // åœ°ä¸Šæ°—æ¸©ï¼ˆæ‘‚æ°ï¼‰
  groundElevationFt: number;  // åœ°ä¸Šæ¨™é«˜ï¼ˆãƒ•ã‚£ãƒ¼ãƒˆï¼‰
  totalDistance: number;      // ç·è·é›¢ï¼ˆæµ·é‡Œï¼‰
  ete: string;                // æ‰€è¦æ™‚é–“ï¼ˆhh:mm:ssï¼‰
  eta: string;                // åˆ°ç€äºˆå®šæ™‚åˆ»
  tas: number;                // çœŸå¯¾æ°—é€Ÿåº¦ï¼ˆãƒãƒƒãƒˆï¼‰
  mach: number;               // ãƒãƒƒãƒæ•°
  routeSegments: RouteSegment[]; // ãƒ«ãƒ¼ãƒˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
}
```

#### **WaypointOptionå‹** â­NEW (2025å¹´10æœˆ13æ—¥è¿½åŠ )
```typescript
export interface WaypointOption extends CustomSelectOption {
  value: string;      // Waypoint ID (ä¾‹: "ABASA", "ADNEX")
  label: string;      // è¡¨ç¤ºå "ID - name1"å½¢å¼ (ä¾‹: "ABASA - ã‚¢ãƒã‚µ")
  name: string;       // Waypointå (ä¾‹: "ã‚¢ãƒã‚µ")
  type: string;       // Waypointã‚¿ã‚¤ãƒ— (ä¾‹: "Non-Compulsory")
  latitude: number;   // ç·¯åº¦
  longitude: number;  // çµŒåº¦
}
```

**ç”¨é€”**:
- react-selectã§ã®Waypointé¸æŠã‚ªãƒ—ã‚·ãƒ§ãƒ³
- Waypoints.jsonã‹ã‚‰èª­ã¿è¾¼ã‚“ã å ±å‘Šç‚¹ãƒ‡ãƒ¼ã‚¿ã®å‹
- æ¤œç´¢å¯èƒ½ãªWaypointãƒªã‚¹ãƒˆã®è¡¨ç¤º

### **ä½¿ç”¨ä¾‹**

#### **Waypointã®é¸æŠã¨è¿½åŠ ** â­NEW (2025å¹´10æœˆ13æ—¥)
```typescript
// Waypoints.jsonã‹ã‚‰èª­ã¿è¾¼ã‚“ã Waypointã‚’é¸æŠ
const selectedWaypoint: WaypointOption = {
  value: 'ADNEX',
  label: 'ADNEX - ã‚¢ãƒ‰ãƒã‚¯ã‚¹',
  name: 'ã‚¢ãƒ‰ãƒã‚¯ã‚¹',
  type: 'Non-Compulsory',
  latitude: 33.667361,
  longitude: 130.668056
};

// å‰ã®ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰ã®æƒ…å ±ã‚’è¨ˆç®—ãƒ»è¡¨ç¤º
const fromPrevious = calculateFromPrevious(); // { bearing: 45.2, distance: 12.5 }
const toNext = calculateToNext();             // { bearing: 180.0, distance: 50.3 }

// Waypointã‚’ç›´æ¥è¿½åŠ ï¼ˆã‚ªãƒ•ã‚»ãƒƒãƒˆè¨ˆç®—ä¸è¦ï¼‰
const waypoint: Waypoint = {
  id: selectedWaypoint.value,
  name: selectedWaypoint.name,
  type: 'waypoint',
  coordinates: [selectedWaypoint.longitude, selectedWaypoint.latitude],
  latitude: selectedWaypoint.latitude,
  longitude: selectedWaypoint.longitude,
  metadata: {
    baseNavaid: selectedWaypoint.name,
    baseLatitude: selectedWaypoint.latitude,
    baseLongitude: selectedWaypoint.longitude
    // bearing, distanceã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãªã®ã§çœç•¥å¯èƒ½
  }
};
```

#### **NAVAIDã‹ã‚‰ã®ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆè¿½åŠ **
```typescript
// AHTï¼ˆèŠ¦å±‹TACANï¼‰ã‹ã‚‰ç£æ–¹ä½030åº¦ã€23æµ·é‡Œã®åœ°ç‚¹
const navaid = { name: 'AHT', latitude: 33.8814, longitude: 130.6517 };
const bearing = 30;  // ç£æ–¹ä½
const distance = 23; // æµ·é‡Œ

const offset = calculateOffsetPoint(
  navaid.latitude,
  navaid.longitude,
  bearing,
  distance
);

// çµæœ: offset = { lat: 34.xxxx, lon: 130.xxxx }
// ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆå: "AHT/030Â°/23nm"
```

### **å°†æ¥ã®æ‹¡å¼µäºˆå®š**

#### **çŸ­æœŸï¼ˆ1-3ãƒ¶æœˆï¼‰**
- **é¢¨è£œæ­£**: é¢¨å‘ãƒ»é¢¨é€Ÿã‚’è€ƒæ…®ã—ãŸé£›è¡Œæ™‚é–“è¨ˆç®—
- **ç‡ƒæ–™è¨ˆç®—**: æ¶ˆè²»ç‡ƒæ–™é‡ã®è‡ªå‹•è¨ˆç®—
- **NOTAMé€£æº**: èˆªç©ºæƒ…å ±ã®è‡ªå‹•å–å¾—ãƒ»è¡¨ç¤º

#### **ä¸­æœŸï¼ˆ3-6ãƒ¶æœˆï¼‰**
- **SID/STAR**: æ¨™æº–å‡ºç™ºãƒ»åˆ°ç€æ–¹å¼ã®è‡ªå‹•è¨­å®š
- **Airways**: èˆªç©ºè·¯ã®è‡ªå‹•ç”Ÿæˆ
- **åœ°å½¢å›é¿**: æœ€ä½å®‰å…¨é«˜åº¦ã®è‡ªå‹•ãƒã‚§ãƒƒã‚¯

#### **é•·æœŸï¼ˆ6ãƒ¶æœˆä»¥ä¸Šï¼‰**
- **è¤‡æ•°ãƒ«ãƒ¼ãƒˆæ¯”è¼ƒ**: æœ€é©ãƒ«ãƒ¼ãƒˆã®è‡ªå‹•ææ¡ˆ
- **å¤©æ°—äºˆå ±é€£æº**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ°—è±¡æƒ…å ±ã®çµ±åˆ
- **ATCé€£æº**: ç®¡åˆ¶æ‰¿èªãƒ«ãƒ¼ãƒˆã®è‡ªå‹•å–å¾—

### **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶**

- **ã‚ªãƒ•ã‚»ãƒƒãƒˆè¨ˆç®—**: < 10ms
- **ãƒ«ãƒ¼ãƒˆæ›´æ–°**: < 100ms
- **åœ°å›³å†æç”»**: < 50ms
- **ç·ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆæ•°**: æœ€å¤§100å€‹

### **ãƒ†ã‚¹ãƒˆé …ç›®**

#### **å˜ä½“ãƒ†ã‚¹ãƒˆ**
- [ ] calculateOffsetPointé–¢æ•°ã®ç²¾åº¦æ¤œè¨¼
- [ ] ç£æ°—åå·®è£œæ­£ã®æ­£ç¢ºæ€§
- [ ] å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆï¼ˆ0åº¦ã€360åº¦ã€æ¥µåœ°ä»˜è¿‘ï¼‰

#### **çµ±åˆãƒ†ã‚¹ãƒˆ**
- [ ] NAVAIDé¸æŠã‹ã‚‰è¿½åŠ ã¾ã§ã®ãƒ•ãƒ­ãƒ¼
- [ ] ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆã®ç·¨é›†ãƒ»å‰Šé™¤
- [ ] è¤‡æ•°ã‚¦ã‚§ã‚¤ãƒã‚¤ãƒ³ãƒˆã®é †åºå¤‰æ›´

#### **E2Eãƒ†ã‚¹ãƒˆ**
- [ ] å®Œå…¨ãªãƒ•ãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³ä½œæˆ
- [ ] åœ°å›³ä¸Šã§ã®è¦–è¦šçš„ç¢ºèª
- [ ] é£›è¡Œæ™‚é–“ãƒ»è·é›¢ã®è¨ˆç®—ç²¾åº¦

---

## ğŸ¨ ãƒ†ãƒ¼ãƒã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆï¼ˆv1.2è¿½åŠ ï¼‰

### **ãƒ†ãƒ¼ãƒç®¡ç†ã‚·ã‚¹ãƒ†ãƒ **

#### **ThemeContextè¨­è¨ˆ**
```typescript
interface ThemeContextType {
  theme: 'day' | 'dark' | 'auto';
  effectiveTheme: 'day' | 'dark';
  setTheme: (theme: 'day' | 'dark' | 'auto') => void;
}
```

#### **ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆãƒ­ã‚¸ãƒƒã‚¯**
- **Dayãƒ†ãƒ¼ãƒ**: æ˜ã‚‹ã„èƒŒæ™¯ã€HUDã‚°ãƒªãƒ¼ãƒ³ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ
- **Darkãƒ†ãƒ¼ãƒ**: æš—ã„èƒŒæ™¯ã€ã‚³ãƒƒã‚¯ãƒ”ãƒƒãƒˆèµ¤è‰²ç…§æ˜ãƒ‡ã‚¶ã‚¤ãƒ³
- **Autoãƒ†ãƒ¼ãƒ**: æ™‚é–“å¸¯ã«å¿œã˜ã¦è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆï¼ˆ6:00-18:00: Dayã€18:00-6:00: Darkï¼‰

### **HUDã‚¹ã‚¿ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ **

#### **CSSå¤‰æ•°å®šç¾©**
```css
/* Dayãƒ†ãƒ¼ãƒ */
.day {
  --hud-primary: #39FF14;
  --hud-secondary: #00FF00;
  --hud-dim: #00CC00;
  --hud-glow: #39FF14;
  --hud-grid: #00FF00;
  --bg: #0b1d3a;
  --panel: #1a2a4a;
  --text-primary: #ffffff;
  --text-muted: #a0a0a0;
  --ring: #39FF14;
}

/* Darkãƒ†ãƒ¼ãƒ */
.dark {
  --hud-primary: #ff4444;
  --hud-secondary: #ff6666;
  --hud-dim: #cc3333;
  --hud-glow: #ff4444;
  --hud-grid: #ff4444;
  --bg: #0a0a0a;
  --panel: #1a1a1a;
  --text-primary: #ffffff;
  --text-muted: #888888;
  --ring: #ff4444;
}
```

#### **HUDãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹**
```css
.hud-text { color: var(--text-primary); }
.hud-input { background: var(--panel); color: var(--text-primary); }
.hud-border { border-color: var(--hud-primary); }
.hud-surface { background: var(--panel); }
.hud-line { border-color: var(--hud-primary); }
.hud-glow { box-shadow: 0 0 10px var(--hud-glow); }
```

### **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ¥ãƒ†ãƒ¼ãƒé©ç”¨**

#### **Articlesãƒšãƒ¼ã‚¸çµ±ä¸€ãƒ‡ã‚¶ã‚¤ãƒ³**
- **ArticleDashboard**: NavyBlueèƒŒæ™¯ï¼ˆ`#0b1d3a`ï¼‰ã€HUDæ ç·š
- **è¨˜äº‹ã‚«ãƒ¼ãƒ‰**: `hud-surface`èƒŒæ™¯ã€`hover:bg-white/10`ãƒ›ãƒãƒ¼åŠ¹æœ
- **çµ±è¨ˆã‚«ãƒ¼ãƒ‰**: HUDã‚¹ã‚¿ã‚¤ãƒ«çµ±ä¸€ã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ

#### **å­¦ç¿’é€²æ—ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**
- **ProgressSummaryHeader**: çµ±è¨ˆã‚«ãƒ¼ãƒ‰ã€ä»Šæ—¥ã®ç›®æ¨™ã‚»ã‚¯ã‚·ãƒ§ãƒ³
- **ProgressSidebar**: ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥é€²æ—ã€ã‚·ãƒªãƒ¼ã‚ºåˆ¥é€²æ—
- **EnhancedArticleCard**: è¨˜äº‹ã‚«ãƒ¼ãƒ‰ã€é€²æ—è¡¨ç¤º

#### **åˆ†æã‚«ãƒ¼ãƒ‰çµ±ä¸€**
- **ã€Œæ›´ã«è©³ã—ã„å­¦ç¿’åˆ†æã‚’ä½“é¨“ã€**: HUDã‚¹ã‚¿ã‚¤ãƒ«ã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
- **ã€Œã‚‚ã£ã¨è©³ã—ã„åˆ†æã‚’è¦‹ã‚‹ã€**: HUDã‚¹ã‚¿ã‚¤ãƒ«ã€ãƒ›ãƒãƒ¼åŠ¹æœ

### **ç™»éŒ²ãƒœã‚¿ãƒ³æ©Ÿèƒ½è¨­è¨ˆ**

#### **é·ç§»ã‚·ã‚¹ãƒ†ãƒ **
```typescript
// ArticleDashboard.tsx
const showRegistrationModal = useCallback(() => {
  navigate('/auth');
}, [navigate]);
```

#### **ãƒœã‚¿ãƒ³é…ç½®**
- **ProgressSummaryHeader**: ã€Œâœ¨ ç„¡æ–™ã§ç™»éŒ²ã€ãƒœã‚¿ãƒ³
- **ProgressSidebar**: ã€Œç„¡æ–™ã§å§‹ã‚ã‚‹ã€ãƒœã‚¿ãƒ³
- **EnhancedArticleCard**: ã€Œç™»éŒ²ã—ã¦è¦‹ã‚‹ã€ãƒœã‚¿ãƒ³
- **ArticleDashboard**: ã€Œæ›´ã«è©³ã—ã„å­¦ç¿’åˆ†æã‚’ä½“é¨“ã€ãƒœã‚¿ãƒ³

---

## ğŸš€ é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### **å‰æãƒ„ãƒ¼ãƒ«**
- Node.js 16.xä»¥ä¸Š
- npm 7.xä»¥ä¸Š
- Git
- Cursor IDEï¼ˆæ¨å¥¨ï¼‰

### **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †**

**1. ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³**
```bash
git clone https://github.com/yourusername/FlightAcademyTsx.git
cd FlightAcademyTsx
```

**2. ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
```bash
npm install
```

**3. ç’°å¢ƒå¤‰æ•°è¨­å®š**
```bash
cp .env.example .env.local
# .env.localã«å¿…è¦ãªAPIã‚­ãƒ¼ã‚’è¨­å®š
```

**4. Supabase CLIè¨­å®š**
```bash
npm install -g @supabase/cli
supabase login
supabase init
```

**5. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•**
```bash
npm run dev
```

### **Tailwind CSSè¨­å®š**

**tailwind.config.js**:
```javascript
module.exports = {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#eff6ff',
          500: '#3b82f6',
          900: '#1e3a8a',
        }
      }
    },
  },
  plugins: [],
}
```

---

## ğŸ¨ Articlesãƒšãƒ¼ã‚¸ãƒ†ãƒ¼ãƒçµ±ä¸€è¨­è¨ˆä»•æ§˜

### **ãƒ†ãƒ¼ãƒã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ**

#### **Dayãƒ†ãƒ¼ãƒï¼ˆHUDã‚°ãƒªãƒ¼ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ï¼‰**
```css
/* ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ */
.card-day {
  background: var(--hud-surface);
  border: 2px solid rgba(34, 197, 94, 0.5); /* border-green-500/50 */
  border-radius: 0.75rem; /* rounded-xl */
  box-shadow: 0 10px 15px -3px rgba(34, 197, 94, 0.1); /* shadow-green-900/10 */
  padding: 1.25rem; /* p-5 */
}

/* ãƒ†ã‚­ã‚¹ãƒˆã‚«ãƒ©ãƒ¼ */
.text-day {
  color: #39FF14; /* HUDã‚°ãƒªãƒ¼ãƒ³ */
}

/* èƒŒæ™¯ */
.bg-day {
  background: #0b1d3a; /* NavyBlue */
}
```

#### **Darkãƒ†ãƒ¼ãƒï¼ˆã‚³ãƒƒã‚¯ãƒ”ãƒƒãƒˆèµ¤è‰²ç…§æ˜ãƒ‡ã‚¶ã‚¤ãƒ³ï¼‰**
```css
/* ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ */
.card-dark {
  background: var(--hud-surface);
  border: 2px solid rgba(239, 68, 68, 0.6); /* border-red-500/60 */
  border-radius: 0.75rem; /* rounded-xl */
  box-shadow: 0 10px 15px -3px rgba(239, 68, 68, 0.2); /* shadow-red-900/20 */
  padding: 1.25rem; /* p-5 */
}

/* ãƒ†ã‚­ã‚¹ãƒˆã‚«ãƒ©ãƒ¼ */
.text-dark {
  color: #ffffff; /* ç™½è‰² */
}

/* èƒŒæ™¯ */
.bg-dark {
  background: var(--bg); /* CSSå¤‰æ•° */
}
```

### **çµ±ä¸€ã•ã‚ŒãŸã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ä»•æ§˜**

#### **åŸºæœ¬ã‚«ãƒ¼ãƒ‰æ§‹é€ **
```typescript
interface CardDesign {
  borderRadius: 'rounded-xl'; // çµ±ä¸€ã•ã‚ŒãŸè§’ä¸¸
  borderWidth: 'border-2'; // çµ±ä¸€ã•ã‚ŒãŸæ ç·šå¤ªã•
  shadow: 'shadow-lg'; // çµ±ä¸€ã•ã‚ŒãŸã‚·ãƒ£ãƒ‰ã‚¦
  padding: 'p-5' | 'p-3 sm:p-4'; // é©åˆ‡ãªãƒ‘ãƒ‡ã‚£ãƒ³ã‚°
  backdropBlur: 'backdrop-blur-sm'; // èƒŒæ™¯ãƒ–ãƒ©ãƒ¼
}
```

#### **ãƒ†ãƒ¼ãƒå¯¾å¿œã‚«ãƒ©ãƒ¼**
```typescript
interface ThemeColors {
  day: {
    border: 'border-green-500/50';
    shadow: 'shadow-green-900/10';
    text: 'text-[#39FF14]';
    background: '#0b1d3a';
  };
  dark: {
    border: 'border-red-500/60';
    shadow: 'shadow-red-900/20';
    text: 'text-white';
    background: 'var(--bg)';
  };
}
```

### **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ¥ãƒ‡ã‚¶ã‚¤ãƒ³ä»•æ§˜**

#### **ArticleSearch & ArticleSortControls**
- **è§’ä¸¸**: `rounded-xl`
- **æ ç·š**: `border-2` + ãƒ†ãƒ¼ãƒå¯¾å¿œè‰²
- **ã‚·ãƒ£ãƒ‰ã‚¦**: `shadow-lg` + ãƒ†ãƒ¼ãƒå¯¾å¿œè‰²
- **ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°**: `p-5`

#### **ProgressSidebar**
- **ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥é€²æ—ã‚«ãƒ¼ãƒ‰**: `rounded-xl border-2 shadow-lg p-5`
- **ã‚·ãƒªãƒ¼ã‚ºåˆ¥é€²æ—ã‚«ãƒ¼ãƒ‰**: `rounded-xl border-2 shadow-lg p-5`
- **æœ€è¿‘ã®æ´»å‹•ã‚«ãƒ¼ãƒ‰**: `rounded-xl border-2 shadow-lg p-5`

#### **EnhancedArticleCard**
- **è§’ä¸¸**: `rounded-xl`
- **æ ç·š**: `border-2` + ãƒ†ãƒ¼ãƒå¯¾å¿œè‰²
- **ã‚·ãƒ£ãƒ‰ã‚¦**: `shadow-lg hover:shadow-xl` + ãƒ†ãƒ¼ãƒå¯¾å¿œè‰²
- **ãƒ›ãƒãƒ¼åŠ¹æœ**: `hover:bg-white/10`

#### **ProgressSummaryHeader**
- **ãƒ¡ã‚¤ãƒ³ã‚«ãƒ¼ãƒ‰**: `rounded-xl border-2 shadow-lg p-6`
- **çµ±è¨ˆã‚«ãƒ¼ãƒ‰**: `rounded-xl border-2 shadow-lg p-3 sm:p-4`

## ğŸ“ ä»Šå¾Œã®æ”¹å–„ç‚¹

### **çŸ­æœŸæ”¹å–„ï¼ˆ1-3ãƒ¶æœˆï¼‰**
- UI/UXã®ç¶™ç¶šçš„æ”¹å–„
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- ãƒã‚°ä¿®æ­£ã¨ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸å‘ä¸Š

### **ä¸­æœŸæ”¹å–„ï¼ˆ3-6ãƒ¶æœˆï¼‰**
- AIæ©Ÿèƒ½ã®å¼·åŒ–
- ç®¡ç†æ©Ÿèƒ½ã®å……å®Ÿ
- ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªåŒ–æ¤œè¨

### **é•·æœŸæ”¹å–„ï¼ˆ6ãƒ¶æœˆä»¥ä¸Šï¼‰**
- ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ
- é«˜åº¦ãªå­¦ç¿’åˆ†ææ©Ÿèƒ½
- å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ é€£æº

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### **æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ã‚¬ã‚¤ãƒ‰**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ã€æ©Ÿèƒ½è©³ç´°
- **æŠ€è¡“é–‹ç™ºã‚¬ã‚¤ãƒ‰**: æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã€é–‹ç™ºç’°å¢ƒ
- **è¨ˆç”»æ”¹å–„ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—**: é–‹ç™ºè¨ˆç”»ã€æ”¹å–„ææ¡ˆ
- **é‹ç”¨ä¿å®ˆã‚¬ã‚¤ãƒ‰**: è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

## ğŸ” è¨˜äº‹ã‚«ãƒ¼ãƒ‰çµ±è¨ˆãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºçµ±ä¸€è¨­è¨ˆä»•æ§˜ï¼ˆv1.3è¿½åŠ ï¼‰

### **çµ±è¨ˆãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã®çµ±ä¸€è¨­è¨ˆ**

#### **ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã«å¿œã˜ãŸè¡¨ç¤ºåˆ¶å¾¡**
```typescript
// EnhancedArticleCard.tsx
const { user } = useAuth();
const isLoggedIn = !!user;

// çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¤ºåˆ¶å¾¡
{stats && (
  <div className="flex items-center space-x-3 text-xs">
    {/* ã„ã„ã­ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆã¯ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿è¡¨ç¤º */}
    {isLoggedIn && (
      <>
        <div className="likes-display">
          <span className={stats.user_liked ? 'â¤ï¸' : 'ğŸ¤'}></span>
          <span>{stats.likes_count}</span>
        </div>
        <div className="comments-display">
          <span>ğŸ’¬</span>
          <span>{stats.comments_count}</span>
        </div>
      </>
    )}

    {/* é–²è¦§æ•°ã¯å¸¸ã«è¡¨ç¤º */}
    <div className="views-display">
      <span>ğŸ‘€</span>
      <span>{stats.views_count}</span>
    </div>
  </div>
)}
```

#### **çµ±è¨ˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã®çµ±ä¸€è¨­è¨ˆ**
```typescript
// ArticleDashboard.tsx
// è¨˜äº‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸå¾Œã«çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
React.useEffect(() => {
  if (articleContents.length > 0) {
    const articleIds = articleContents.map(content => content.id);
    loadArticleStats(articleIds);
  }
}, [articleContents, loadArticleStats]);

// çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®å–å¾—ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’æä¾›ï¼‰
const stats = socialStats[article.id] || {
  likes_count: 0,
  comments_count: 0,
  views_count: 0,
  user_liked: false
};
```

#### **é–²è¦§æ•°è‡ªå‹•ã‚«ã‚¦ãƒ³ãƒˆè¨­è¨ˆ**
```typescript
// ArticleDashboard.tsx
const handleArticleClick = async (articleId: string) => {
  try {
    await recordView({ article_id: articleId });
  } catch (error) {
    console.error('é–²è¦§æ•°ã®è¨˜éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
  }
};

// EnhancedArticleCard.tsx
<Link
  to={`/articles/${article.id}`}
  onClick={onArticleClick}
  className="article-title-link"
>
  {articleMeta?.title || article.title}
</Link>
```

#### **ã„ã„ã­ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½ã®åˆ¶é™è¨­è¨ˆ**
```typescript
// useArticleStats.ts
const toggleLike = useCallback(async (request: ToggleLikeRequest) => {
  if (!user) {
    alert('ã„ã„ã­ã™ã‚‹ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™');
    return;
  }

  // ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ã®ã„ã„ã­å‡¦ç†
  // ...
}, [user, stats, supabase]);

const createComment = useCallback(async (request: CreateCommentRequest) => {
  if (!user) {
    alert('ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™');
    return;
  }

  // ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ã®ã‚³ãƒ¡ãƒ³ãƒˆå‡¦ç†
  // ...
}, [user, supabase, loadComments]);
```

#### **å…¬é–‹æ—¥ã®çµ±ä¸€è¡¨ç¤ºè¨­è¨ˆ**
```typescript
// EnhancedArticleCard.tsx
{(articleMeta?.publishedAt || article.created_at) && (
  <div className="published-date">
    <span>ğŸ“…</span>
    <span>
      {new Date(articleMeta?.publishedAt || article.created_at).toLocaleDateString('ja-JP', {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
      })}
    </span>
  </div>
)}
```

### **ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ**

#### **çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®æµã‚Œ**
1. **è¨˜äº‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„èª­ã¿è¾¼ã¿** â†’ `articleContents`ãŒæ›´æ–°
2. **çµ±è¨ˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿** â†’ `useEffect`ã§`loadArticleStats`ã‚’å‘¼ã³å‡ºã—
3. **çµ±è¨ˆãƒ‡ãƒ¼ã‚¿è¡¨ç¤º** â†’ `EnhancedArticleCard`ã§ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã«å¿œã˜ã¦è¡¨ç¤º
4. **é–²è¦§æ•°è¨˜éŒ²** â†’ è¨˜äº‹ã‚¯ãƒªãƒƒã‚¯æ™‚ã«`recordView`ã‚’å‘¼ã³å‡ºã—

#### **ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã®åˆ¤å®šãƒ•ãƒ­ãƒ¼**
1. **èªè¨¼çŠ¶æ…‹ç¢ºèª** â†’ `useAuth`ãƒ•ãƒƒã‚¯ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—
2. **è¡¨ç¤ºåˆ¶å¾¡** â†’ `isLoggedIn`ãƒ•ãƒ©ã‚°ã§è¡¨ç¤ºå†…å®¹ã‚’åˆ¶å¾¡
3. **æ©Ÿèƒ½åˆ¶é™** â†’ ã„ã„ã­ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½ã§ãƒ­ã‚°ã‚¤ãƒ³å¿…é ˆãƒã‚§ãƒƒã‚¯

### **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ**

#### **ãƒ­ã‚°ã‚¤ãƒ³åˆ¶é™ã®å®Ÿè£…**
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰åˆ¶é™**: UIè¡¨ç¤ºã®åˆ¶å¾¡
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åˆ¶é™**: Supabaseã®RLSï¼ˆRow Level Securityï¼‰ã§ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“**: åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ä¿ƒé€²ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º

#### **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ç¢ºä¿**
- **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®æä¾›**: çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„å ´åˆã®çµ±ä¸€è¡¨ç¤º
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: çµ±è¨ˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å¤±æ•—æ™‚ã®é©åˆ‡ãªå‡¦ç†
- **å‹å®‰å…¨æ€§**: TypeScriptã«ã‚ˆã‚‹å‹ãƒã‚§ãƒƒã‚¯

### **å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹**
- [Supabase Documentation](https://supabase.com/docs)
- [React Documentation](https://react.dev/)
- [TypeScript Documentation](https://www.typescriptlang.org/docs/)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´9æœˆ23æ—¥
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: Design Specification v1.3
**ç®¡ç†è€…**: FlightAcademyé–‹ç™ºãƒãƒ¼ãƒ 
